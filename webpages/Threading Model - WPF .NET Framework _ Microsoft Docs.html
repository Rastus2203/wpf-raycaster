<!DOCTYPE html>
<!-- saved from url=(0105)https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8 -->
<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus js-focus-visible theme-dark" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="true" data-target="docs" x-ms-format-detection="none" data-js-focus-visible=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="vjs-styles-defaults">
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid {
        padding-top: 56.25%
      }
    </style>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta property="og:title" content="Threading Model - WPF .NET Framework">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model">
			<meta property="og:description" content="Learn about situations where you might need multiple threads in your Windows Presentation Foundation application. Single threaded solutions are preferred.">
		<meta property="og:image" content="https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png">
		<meta property="og:image:alt" content="Microsoft Logo">

	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@docsmsft">


	<meta name="author" content="adegeo">
<meta name="breadcrumb_path" content="/dotnet/desktop/breadcrumb/toc.json">
<meta name="depot_name" content="MSDN.dotnet-desktop-guide">
<meta name="description" content="Learn about situations where you might need multiple threads in your Windows Presentation Foundation application. Single threaded solutions are preferred.">
<meta name="document_id" content="b0bc9d86-b893-7c9f-d832-3c3026f5278e">
<meta name="document_version_independent_id" content="5d75b64a-62d1-b0f9-b8fd-c84f60318808">
<meta name="gitcommit" content="https://github.com/dotnet/docs-desktop/blob/da363692ff6d30641003148c90cd8d0e7fa5ddf6/dotnet-desktop-guide/framework/wpf/advanced/threading-model.md">
<meta name="locale" content="en-us">
<meta name="monikers" content="netframeworkdesktop-4.8">
<meta name="ms.assetid" content="02d8fd00-8d7c-4604-874c-58e40786770b">
<meta name="ms.author" content="adegeo">
<meta name="ms.date" content="03/30/2017">
<meta name="ms.prod" content="dotnet-framework">
<meta name="ms.technology" content="dotnet-wpf">
<meta name="original_content_git_url" content="https://github.com/dotnet/docs-desktop/blob/live/dotnet-desktop-guide/framework/wpf/advanced/threading-model.md">
<meta name="search.ms_docsetname" content="dotnet-desktop-guide">
<meta name="search.ms_product" content="MSDN">
<meta name="search.ms_sitename" content="Docs">
<meta name="site_name" content="Docs">
<meta name="updated_at" content="2020-09-04 04:58 PM">
<meta name="page_type" content="conceptual">
<meta name="toc_rel" content="toc.json">
<meta name="pdf_url_template" content="https://docs.microsoft.com/pdfstore/en-us/MSDN.dotnet-desktop-guide/{branchName}{pdfName}">
<meta name="search.mshattr.devlang" content="csharp vb">
<meta name="word_count" content="5011">


<link href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model" rel="canonical">
	<title>Threading Model - WPF .NET Framework | Microsoft Docs</title>

		<link rel="stylesheet" href="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/d6c593e3.site-ltr.css">

	<link rel="stylesheet" href="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/2e5ce4ab.conceptual.css">


	<script async="" defer="" crossorigin="anonymous" src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/lux.js.download"></script><script async="" src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/analytics.js.download"></script><script>
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: true,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'GitHub',
			feedbackGitHubRepo: 'dotnet/docs-desktop',
			feedbackProductUrl: 'https://developercommunity.visualstudio.com/spaces/61/index.html',
			contentGitUrl: 'https://github.com/dotnet/docs-desktop/blob/live/dotnet-desktop-guide/framework/wpf/advanced/threading-model.md',
			extendBreadcrumb: false,
			isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true
		},
		functions:{}
	};
	</script>
	<script nomodule="" src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/bluebird.min.js.download" integrity="sha384-aD4BDeDGeLXLpPK4yKeqtZQa9dv4a/7mQ+4L5vwshIYH1Mc2BrXvHd32iHzYCQy5" crossorigin="anonymous"></script>
	<script nomodule="" src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/fetch.umd.min.js.download" integrity="sha384-EQIXrC5K2+7X8nGgLkB995I0/6jfAvvyG1ieZ+WYGxgJHFMD/alsG9fSDWvzb5Y1" crossorigin="anonymous"></script>
	<script nomodule="" src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/template.min.js.download" integrity="sha384-1zKzI6ldTVHMU7n0W2HpE/lhHI+UG4D9IIaxbj3kT2UhCWicdTuJkTtnKuu0CQzN" crossorigin="anonymous"></script>
	<script nomodule="" src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/url.min.js.download" integrity="sha384-vn7xBMtpSTfzaTRWxj0kVq0UcsbBrTOgZ/M1ISHqe1V358elYva+lfiEC+T8jLPc" crossorigin="anonymous"></script>
	<script src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/7501e2bd.index-polyfills.js.download"></script>
		<script src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/b44ee89d.index-docs.js.download"></script><style>
		[data-moniker]:not([data-moniker~='netframeworkdesktop-4.8']) {
			display: none !important;
		}
	</style><script src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/jsll-4.js.download" async="" defer=""></script>
</head>

<body lang="en-us" dir="ltr">
<div class="header-holder has-default-focus">
	<a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused is-fixed has-inner-focus focus-visible has-top-zero has-left-zero has-right-zero has-padding-medium has-text-centered has-body-background-medium" tabindex="1">Skip to main content</a>
	
	<div id="ignite-banner-holder" class="has-default-focus has-overflow-hidden"><!---->
		<section id="ignite-banner" data-bi-name="ignite-banner" data-dismissable="disappearing" class="uhf-container ignite-banner has-padding has-padding-top-medium has-padding-bottom-medium is-banner">
			<div class="columns is-relative is-gapless-mobile">
				<div class="column is-4 is-3-desktop">
					<span class="is-size-h3 has-text-weight-semibold is-block has-margin-bottom-extra-small">
						Microsoft Ignite
					</span>
					<span class="is-size-small is-block">
						September 22–24, 2020 | Free digital event
					</span>
				</div>
				<div class="column is-3 is-hidden-touch is-flex has-flex-align-self-center">
					<span class="is-size-h5 is-block has-margin-left-large has-margin-right-large">
						Learn. Connect. Explore.
					</span>
				</div>
				<div class="column is-flex has-flex-align-self-center">
					<a id="ignite-banner-anchor" class="button is-small has-margin-top-small has-margin-none-tablet" data-bi-name="CTA" href="https://myignite.microsoft.com/?wt.mc_id=ignite_bn_oo_docs__home_">
						<span>
							Register now
						</span>
						<span class="icon">
							<span class="docon docon-chevron-right-light" aria-hidden="true"></span>
						</span>
					</a>
				</div>
				<button type="button" data-dismiss="" data-bi-name="close" class="is-tertiary button has-inner-focus delete is-large is-absolute has-top-zero has-right-zero has-margin-small">
					<span class="visually-hidden"><!---->Dismiss alert<!----></span>
				</button>
			</div>
		</section>
	<!----></div>

	<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization"><!----> <div class="nav-bar"><!---->  <div class="nav-bar-brand">
		<a class="nav-bar-button" itemprop="url" href="https://www.microsoft.com/" aria-label="Microsoft">
			<div class="nav-bar-logo" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope">
				<svg xmlns="http://www.w3.org/2000/svg" width="108" height="23" viewBox="72 72 337 74" preserveAspectRatio="xMidYMin slice">
					<g data-name="MS-symbol">
						<clippath id="a">
							<path transform="matrix(1 0 0 -1 0 216)" d="M0 216h482V0H0z"></path>
						</clippath>
						<g clip-path="url(#a)">
							<path class="has-fill-current-color has-text-subtle" d="M394.942 104.59h-10.858v25.003h-7.38V104.59h-5.182v-5.965h5.182v-4.308c0-3.254 1.06-5.92 3.178-7.998 2.12-2.079 4.835-3.118 8.15-3.118.882 0 1.666.045 2.35.135a9.37 9.37 0 011.806.407v6.296c-.24-.14-.663-.31-1.265-.512-.603-.2-1.296-.3-2.078-.3-1.528 0-2.702.476-3.526 1.43-.824.954-1.235 2.365-1.235 4.232v3.736h10.858v-6.959l7.321-2.229v9.188h7.381v5.965h-7.38v14.49c0 1.91.345 3.254 1.038 4.037.693.783 1.782 1.175 3.27 1.175.42 0 .927-.1 1.52-.3a7.178 7.178 0 001.552-.724v6.025c-.463.261-1.23.502-2.305.723a15.742 15.742 0 01-3.178.331c-3.073 0-5.378-.817-6.914-2.455-1.537-1.637-2.305-4.102-2.305-7.396zm-48.407 9.73c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.45-2.545-6.04-2.545-2.67 0-4.745.888-6.22 2.666-1.477 1.777-2.215 4.313-2.215 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.892-2.993 6.91-4.489 12.05-4.489 4.841 0 8.621 1.441 11.343 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.447 9.018-4.338 11.99-2.892 2.973-6.829 4.458-11.81 4.458-4.8 0-8.61-1.41-11.432-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-16.417-7.802c0 1.045.331 1.863.994 2.456.662.592 2.128 1.34 4.398 2.243 2.912 1.166 4.956 2.476 6.131 3.932 1.175 1.456 1.762 3.22 1.762 5.287 0 2.912-1.12 5.252-3.359 7.02-2.24 1.767-5.267 2.65-9.083 2.65-1.285 0-2.706-.155-4.263-.467-1.556-.31-2.877-.707-3.96-1.19v-7.169a17.945 17.945 0 004.277 2.198c1.526.543 2.911.814 4.157.814 1.647 0 2.862-.23 3.645-.693.784-.46 1.175-1.235 1.175-2.319 0-1.005-.406-1.853-1.22-2.546-.813-.693-2.355-1.492-4.624-2.395-2.69-1.125-4.599-2.39-5.724-3.796-1.125-1.406-1.687-3.193-1.687-5.362 0-2.792 1.11-5.086 3.33-6.884 2.217-1.797 5.095-2.696 8.63-2.696 1.084 0 2.3.12 3.645.361 1.346.242 2.47.553 3.374.934v6.93c-.964-.644-2.089-1.195-3.374-1.658-1.286-.462-2.56-.693-3.826-.693-1.386 0-2.465.271-3.238.813-.774.543-1.16 1.286-1.16 2.23m-35.066 7.562c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.449-2.545-6.039-2.545-2.672 0-4.745.888-6.222 2.666-1.476 1.777-2.214 4.313-2.214 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.893-2.993 6.91-4.489 12.051-4.489 4.84 0 8.621 1.441 11.342 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.446 9.018-4.338 11.99-2.892 2.973-6.828 4.458-11.809 4.458-4.8 0-8.61-1.41-11.433-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-3.136-16.448c.582 0 1.105.041 1.567.121.462.08.853.18 1.175.301v7.38c-.382-.28-.939-.546-1.672-.798-.733-.25-1.622-.376-2.666-.376-1.788 0-3.299.753-4.534 2.26-1.235 1.505-1.853 3.825-1.853 6.958v15.635h-7.29V98.624h7.29v4.88h.12c.663-1.687 1.667-3.007 3.013-3.96 1.346-.954 2.962-1.432 4.85-1.432m-27.956 26.18c1.084 0 2.28-.25 3.585-.754a15.06 15.06 0 003.615-1.988v6.778c-1.165.663-2.485 1.165-3.962 1.506-1.475.342-3.098.512-4.865.512-4.559 0-8.265-1.44-11.116-4.323-2.852-2.88-4.278-6.562-4.278-11.04 0-4.98 1.456-9.083 4.37-12.307 2.91-3.224 7.037-4.835 12.38-4.835 1.366 0 2.746.176 4.143.527 1.395.352 2.504.758 3.328 1.22v6.99c-1.125-.824-2.274-1.462-3.45-1.914a9.966 9.966 0 00-3.599-.678c-2.872 0-5.192.934-6.959 2.802-1.768 1.868-2.652 4.388-2.652 7.562 0 3.132.85 5.573 2.546 7.32 1.697 1.748 4.002 2.621 6.914 2.621m-22.112 5.302h-7.29V98.624h7.29zm-8.044-39.916c0-1.205.437-2.214 1.311-3.028.874-.813 1.913-1.22 3.118-1.22 1.285 0 2.35.417 3.193 1.25.844.834 1.266 1.833 1.266 2.998 0 1.185-.432 2.18-1.296 2.982-.864.804-1.918 1.205-3.163 1.205-1.246 0-2.295-.406-3.148-1.219-.854-.815-1.28-1.803-1.28-2.968m-6.274-3.284v43.2h-7.5v-33.86h-.12l-13.408 33.86h-4.97l-13.738-33.86h-.09v33.86h-6.929v-43.2h10.755l12.412 32.024h.18l13.105-32.024z"></path>
							<path d="M106.214 106.214H71.996V71.996h34.218z" fill="#f25022"></path>
							<path d="M143.993 106.214h-34.218V71.996h34.218z" fill="#7fba00"></path>
							<path d="M106.214 143.993H71.996v-34.218h34.218z" fill="#00a4ef"></path>
							<path d="M143.993 143.993h-34.218v-34.218h34.218z" fill="#ffb900"></path>
						</g>
					</g>
				</svg>
			</div>
		</a>
	</div> 
			
		<div class="nav-bar-item is-hidden-tablet">
			<div class="nav-bar-menu">
				<button class="nav-bar-button is-title" title="Global navigation" aria-expanded="false">
					<span class="nav-bar-menu-title"><!---->Documentation<!----></span>
					<div class="nav-bar-burger">
						<span></span>
						<span></span>
						<span></span>
						<span class="nav-bar-burger-label"><!---->Global navigation<!----></span>
					</div>
				</button>
			</div>
		</div>
	
			
		<nav class="nav-bar-nav" role="navigation" aria-label="Global">
			<ul class="nav-bar-nav-list">
				
		<li class="nav-bar-item is-category">
			<a class="nav-bar-button is-title has-hover-underline" itemprop="url" href="https://docs.microsoft.com/en-us/">
				<span><!---->Docs<!----></span>
			</a>
		</li>
	
				<!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline is-active" href="https://docs.microsoft.com/en-us/">
					<span><!---->Documentation<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/en-us/learn/">
					<span><!---->Learn<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/en-us/answers/products/">
					<span><!---->Q&amp;A<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/en-us/samples/browse/">
					<span><!---->Code Samples<!----></span>
				</a>
		  </li><!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  has-hover-underline" aria-controls="ax-46">
			<span><!---->More<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-46" aria-label="More">
			<!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://docs.microsoft.com/en-us/"><!---->Documentation<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://docs.microsoft.com/en-us/learn/"><!---->Learn<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://docs.microsoft.com/en-us/answers/products/"><!---->Q&amp;A<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://docs.microsoft.com/en-us/samples/browse/"><!---->Code Samples<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!---->
			</ul>
		</nav>
	
			<span class="nav-bar-spacer"></span>
			
		<div class="nav-bar-search " id="ax-47" hidden="">
			
		<form class="nav-bar-search-form" method="GET" name="searchForm" role="search" id="searchForm" aria-label="Search" aria-expanded="false" action="https://docs.microsoft.com/en-us/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!----> <div class="control ">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="site-search-input" class="autocomplete-input input   is-small" type="search" name="search" aria-expanded="false" aria-owns="ax-48-listbox" aria-activedescendant="" aria-label="Search" placeholder="Search">

				<span aria-hidden="true" class="icon is-small is-left" hidden="">
					<span class="has-text-primary docon docon-undefined"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-48-listbox" aria-label="site-search-input-suggestions" hidden="">
				
			</ul><!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="">
			
			
			
		</form>
	
		</div>
		
					<div class="nav-bar-search">
						<!-- hidden when the width drops to tablet -->
						
		<form class="nav-bar-search-form" method="GET" name="searchForm" role="search" id="searchFormDesktop" aria-label="Search" aria-expanded="false" action="https://docs.microsoft.com/en-us/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!----> <div class="control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-49" class="autocomplete-input input control has-icons-left  is-small" type="search" name="search" aria-expanded="false" aria-owns="ax-50-listbox" aria-activedescendant="" aria-label="Search" placeholder="Search">

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-search"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-50-listbox" aria-label="ax-49-suggestions" hidden="">
				
			</ul><!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="">
			
			
			
		</form>
	
					</div>
			  
		<div class="nav-bar-search " hidden="">
			<div class="nav-bar-search-form-expander">
				<button id="form-expander" class="nav-bar-button has-hover-underline " title="Search" aria-expanded="false" aria-controls="ax-47">
					
		<span class="is-visually-hidden-mobile"><!---->Search<!----></span>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-search"></span>
		</span>
	
				</button>
			</div>
		</div>
	
			
		<div class="nav-bar-profile">
			
		<a class="docs-sign-in auth-status-determined not-authenticated" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#">
			Sign in
		</a>
	 
		<div class="dropdown has-caret auth-status-determined authenticated">
			<button class="dropdown-trigger button-reset" aria-controls="user-menu" aria-expanded="false" aria-label="Your Account">
				<figure class="image is-36x36">
					<img class="has-body-background-medium is-rounded" alt="" data-profile-property="avatarUrl">
				</figure>
			</button>
			<div class="dropdown-menu box has-flex-justify-content-start has-body-background" id="user-menu" role="menu">
				<div class="media is-user-dir">
					<div class="media-left">
						<figure class="image is-48x48" aria-hidden="true">
							<img class="has-body-background-medium is-rounded" aria-labelledby="displayName" data-profile-property="avatarUrl">
						</figure>
					</div>
					<div class="media-content">
						<p class="title is-size-large">
							<span id="displayName" class="is-inline-truncated has-max-width-200" data-profile-property="displayName"></span>
						</p>
						<p class="subtitle is-size-small has-margin-bottom-none">
							<span class="is-inline-truncated has-max-width-200" data-profile-property="upn"></span>
						</p>
					</div>
				</div>
				<ul class="has-padding-top-small has-padding-bottom-medium">
					<li class="has-padding-top-extra-small has-padding-bottom-extra-small">
						<a href="https://docs.microsoft.com/profile" data-profile-property="profileUrl"><!---->Profile<!----></a>
					</li>
					<li class="has-padding-top-extra-small has-padding-bottom-extra-small">
						<a href="https://docs.microsoft.com/profile" data-profile-property="bookmarksUrl"><!---->Bookmarks<!----></a>
					</li>
					<li class="has-padding-top-extra-small">
						<a href="https://docs.microsoft.com/profile" data-profile-property="collectionsUrl"><!---->Collections<!----></a>
					</li>
				</ul>
				<div class="has-border-top has-padding-top-medium">
					<a class="docs-sign-out" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#"><!---->Sign out<!----></a>
				</div>
			</div>
		</div>
	
		</div>
	
		 <!----></div>  <!----></header>	</div>

				<div class="content-header uhf-container has-padding has-default-focus has-border-bottom-none" data-bi-name="content-header">
				<nav class="has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow" data-bi-name="breadcrumb" itemscope="" itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
					<ul id="page-breadcrumbs" class="breadcrumbs"><!---->
			<!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/?view=netframeworkdesktop-4.8">
								<span itemprop="name">
									Docs
								</span>
						  </a>
					<meta itemprop="position" content="1">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/dotnet/?view=netframeworkdesktop-4.8">
								<span itemprop="name">
									.NET
								</span>
						  </a>
					<meta itemprop="position" content="2">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/dotnet/desktop/?view=netframeworkdesktop-4.8">
								<span itemprop="name">
									Desktop Guide
								</span>
						  </a>
					<meta itemprop="position" content="3">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/?view=netframeworkdesktop-4.8">
								<span itemprop="name">
									Windows Presentation Foundation
								</span>
						  </a>
					<meta itemprop="position" content="4">
				</li><!----> <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
					 <a itemprop="item" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/?view=netframeworkdesktop-4.8">
								<span itemprop="name">
									Advanced
								</span>
						  </a>
					<meta itemprop="position" content="5">
				</li><!---->
		<!----></ul>
				</nav>
			<div class="content-header-controls">
				<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
					<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
					<span class="contents-expand-title">Contents</span>
				</button>
				<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
					<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
					<span>Exit focus mode</span>
				</button>
			</div>
			<div class="has-padding-none-tablet has-padding-medium is-size-small is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
				<ul class="is-hidden-mobile action-list has-flex-justify-content-start has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
					<li>

<div class="language dropdown has-caret is-inline-block has-border-mobile">
	<button class="dropdown-trigger button is-text is-small" aria-controls="language-menu" aria-expanded="false" title="Language" data-bi-name="language">
		<span class="icon is-hidden-desktop has-margin-none">
			<span class="docon docon-code-lang" aria-hidden="true"></span>
		</span>
		<span id="lang-title" class="is-visually-hidden-touch has-flex-align-self-start is-hidden-portrait" dir="ltr">C#</span>
		<span class="icon is-hidden-mobile is-hidden-tablet-only" aria-hidden="true">
			<span class="docon docon-chevron-down-light expanded-indicator"></span>
		</span>
	</button>
	<div class="dropdown-menu has-padding-small" name="language-selector" id="language-selector" role="menu">
		<ul data-bi-name="language-links" dir="ltr">
			<li>
				<a class="button is-text is-small is-fullwidth has-flex-justify-content-start" data-bi-name="lang-csharp" tabindex="0" aria-selected="true">C#</a>
			</li>
			<li>
				<a class="button is-text is-small is-fullwidth has-flex-justify-content-start" data-bi-name="lang-vb" tabindex="0" aria-selected="false">VB</a>
			</li>
		</ul>
	</div>
</div>					</li>
					<li>
						<button type="button" class="bookmark button is-text has-inner-focus is-small is-icon-only-touch" data-list-type="bookmarks" data-bi-name="bookmark" title="Add bookmark for Threading Model - WPF .NET Framework | Microsoft Docs" aria-pressed="false">
							<span class="icon" aria-hidden="true">
								<span class="docon docon-single-bookmark"></span>
							</span>
							<span class="bookmark-status is-visually-hidden-touch is-hidden-portrait">Bookmark</span>
						</button>
					</li>
						<li id="feedback-section-link">
							<a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#feedback" class="button is-text has-inner-focus is-small is-icon-only-touch" data-bi-name="comments" title="Send feedback about this page">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-comment-lines"></span>
								</span>
								<span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
							</a>
						</li>
							<li id="contenteditbtn">
								<a href="https://github.com/dotnet/docs-desktop/blob/live/dotnet-desktop-guide/framework/wpf/advanced/threading-model.md" class="button is-text has-inner-focus is-icon-only-touch is-small" title="Edit This Document" data-bi-name="edit">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-edit-outline"></span>
								</span>
								<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
							</a>
						</li>
					<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" data-bi-name="twitter" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fdotnet%2Fdesktop%2Fwpf%2Fadvanced%2Fthreading-model%3Fview%3Dnetframeworkdesktop-4.8%26WT.mc_id%3Dtwitter&amp;text=Threading%20Model%20-%20WPF%20.NET%20Framework%20%7C%20Microsoft%20Docs&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fdotnet%2Fdesktop%2Fwpf%2Fadvanced%2Fthreading-model%3Fview%3Dnetframeworkdesktop-4.8%26WT.mc_id%3Dtwitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" data-bi-name="linkedin" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fdotnet%2Fdesktop%2Fwpf%2Fadvanced%2Fthreading-model%3Fview%3Dnetframeworkdesktop-4.8%26WT.mc_id%3Dlinkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" data-bi-name="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fdotnet%2Fdesktop%2Fwpf%2Fadvanced%2Fthreading-model%3Fview%3Dnetframeworkdesktop-4.8%26WT.mc_id%3Dfacebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" data-bi-name="email" href="mailto:?subject=%5BShared%20Article%5D%20Threading%20Model%20-%20WPF%20.NET%20Framework%20%7C%20Microsoft%20Docs&amp;body=Threading%20Model%20-%20WPF%20.NET%20Framework%20%7C%20Microsoft%20Docs%0A%0Ahttps%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fdotnet%2Fdesktop%2Fwpf%2Fadvanced%2Fthreading-model%3Fview%3Dnetframeworkdesktop-4.8%26WT.mc_id%3Demail">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>					</li>
				</ul>
				<button type="button" class="has-border contents-button button is-small is-text is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
					<span class="icon">
						<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
					</span>
					<span class="contents-expand-title">Table of contents</span>
				</button>
				<div class="is-invisible"></div>
				<div class="is-hidden-tablet level-item is-flexible level-right">

<div class="language dropdown has-caret is-inline-block has-border-mobile">
	<button class="dropdown-trigger button is-text is-small" aria-controls="language-menu" aria-expanded="false" title="Language" data-bi-name="language">
		<span class="icon is-hidden-desktop has-margin-none">
			<span class="docon docon-code-lang" aria-hidden="true"></span>
		</span>
		<span id="lang-title" class="is-visually-hidden-touch has-flex-align-self-start is-hidden-portrait" dir="ltr">Language</span>
		<span class="icon is-hidden-mobile is-hidden-tablet-only" aria-hidden="true">
			<span class="docon docon-chevron-down-light expanded-indicator"></span>
		</span>
	</button>
	<div class="dropdown-menu has-padding-small" name="language-selector" id="language-selector" role="menu">
		<ul data-bi-name="language-links" dir="ltr">
			<li>
				<a class="button is-text is-small is-fullwidth has-flex-justify-content-start" data-bi-name="lang-csharp" tabindex="0" aria-selected="false">C#</a>
			</li>
			<li>
				<a class="button is-text is-small is-fullwidth has-flex-justify-content-start" data-bi-name="lang-vb" tabindex="0" aria-selected="false">VB</a>
			</li>
		</ul>
	</div>
</div>					<button type="button" class="page-actions-button button is-small is-text is-hidden-tablet has-inner-focus has-border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
						<span class="icon">
							<span class="docon docon-more-vertical" aria-hidden="true"></span>
						</span>
					</button>
				</div>
			</div>
		</div>



	<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus"></div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="is-fixed is-flex is-flex-column" role="navigation" aria-label="Primary" style="width: 364px; top: 24px; bottom: 24px;" data-bi-name="left toc"><div class="moniker-picker2" data-bi-name="moniker-picker"><!---->
		<span class="label has-margin-bottom-extra-small"><!---->Version<!----></span>
		<div class="dropdown has-margin-bottom-small">
			<button class="dropdown-trigger has-flex-justify-content-start is-full-width button is-small has-border has-inner-focus" aria-expanded="false" aria-controls="ax-38">
				<span class="visually-hidden"><!---->Select Version<!----></span>
				<span class="has-text-overflow-ellipsis"><!---->.NET Framework 4.x<!----></span>
				<span class="dropdown-button-chevron" aria-hidden="true">
					<span class="icon docon docon-chevron-down-light expanded-indicator"></span>
				</span>
			</button>
			<ul class="dropdown-menu is-full-width" id="ax-38" aria-label="Product">
						
						
						<!---->
		<li>
					<a class="preserve-view button is-small has-border-none has-inner-focus has-flex-justify-content-start is-full-width has-text-wrap is-text-left" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netdesktop-5.0"><!---->.NET 5.0<!----></a>
			  </li>
	<!---->
		<li>
					<a class="preserve-view button is-small has-border-none has-inner-focus has-flex-justify-content-start is-full-width has-text-wrap is-text-left" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8"><!---->.NET Framework 4.x<!----></a>
			  </li>
	<!---->
				  </ul>
		</div>
	<!----></div><form action="javascript:" role="search" aria-label="Search" class="has-margin-bottom-small"><label class="visually-hidden" for="ax-35">Search</label><div class="autocomplete is-block" data-bi-name="autocomplete"><!----> <div class="control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-35" class="autocomplete-input input control has-icons-left is-full-width is-small" type="text" aria-expanded="false" aria-owns="ax-36-listbox" aria-activedescendant="" placeholder="Filter by title">

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-filter-settings"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-36-listbox" aria-label="ax-35-suggestions" hidden="">
				
			</ul><!----></div></form><ul class="tree is-vertically-scrollable has-flex-grow has-flex-shrink" role="tree" aria-label="Table of contents" data-bi-name="tree" data-is-collapsible="true"><li role="none"><a aria-setsize="17" aria-level="1" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/?view=netframeworkdesktop-4.8">Advanced WPF Areas</a></li><li data-moniker="netframeworkdesktop-4.8" role="none"><a aria-setsize="17" aria-level="1" aria-posinset="2" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/wpf-architecture?view=netframeworkdesktop-4.8">WPF Architecture</a></li><li class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="3" role="treeitem" tabindex="-1" id="title-3-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>XAML in WPF</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="4" role="treeitem" tabindex="-1" id="title-4-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Base Element Classes</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="5" role="treeitem" tabindex="-1" id="title-5-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Element Tree and Serialization</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="6" role="treeitem" tabindex="-1" id="title-6-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>WPF Property System</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="7" role="treeitem" tabindex="-1" id="title-7-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Events</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="8" role="treeitem" tabindex="-1" id="title-8-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Input</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="9" role="treeitem" tabindex="-1" id="title-9-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Drag and Drop</span></li><li class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="10" role="treeitem" tabindex="-1" id="title-10-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Resources</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="11" role="treeitem" tabindex="-1" id="title-11-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Documents</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="12" role="treeitem" tabindex="-1" id="title-12-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Globalization and Localization</span></li><li data-moniker="netframeworkdesktop-4.8" role="none"><a aria-setsize="17" aria-level="1" aria-posinset="13" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/layout?view=netframeworkdesktop-4.8">Layout</a></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="14" role="treeitem" tabindex="-1" id="title-14-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Migration and Interoperability</span></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="15" role="treeitem" tabindex="-1" id="title-15-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Performance</span></li><li data-moniker="netframeworkdesktop-4.8" role="none"><a aria-setsize="17" aria-level="1" aria-posinset="16" role="treeitem" tabindex="0" class="tree-item is-leaf is-selected" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8" aria-current="page">Threading Model</a></li><li data-moniker="netframeworkdesktop-4.8" class="tree-item" aria-setsize="17" aria-level="1" aria-posinset="17" role="treeitem" tabindex="-1" id="title-17-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>WPF Unmanaged API Reference</span></li></ul><a class="button is-small is-text has-flex-justify-content-start has-inner-focus has-margin-top-small has-border-top has-border-bottom has-flex-shrink-none" href="https://docs.microsoft.com/en-us/dotnet/desktop/opbuildpdf/183959a5/wpf/advanced/toc.pdf?branch=live&amp;view=netframeworkdesktop-4.8" data-bi-name="downloadPdf" rel="nofollow"><!----> <span class="icon is-size-extra-small has-text-subtle">
				<span aria-hidden="true" class="docon docon-dictionary-download"></span>
			</span>
			<span><!---->Download PDF<!----></span><!----></a></nav>
			</div>

			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<div class="columns is-gapless-mobile has-large-gaps ">


				<div id="main-column" class="column  is-full is-four-fifths-desktop ">

					<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



						<h1 id="threading-model">Threading Model</h1>

						<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
							<li>
								<time class="" data-article-date="" aria-label="Article review date" datetime="2017-03-30T00:00:00.000Z" data-article-date-source="ms.date">03/30/2017</time>
							</li>
								<li class="readingTime">25 minutes to read</li>
								<li class="contributors-holder">
										<a href="https://github.com/dotnet/docs-desktop/blob/live/dotnet-desktop-guide/framework/wpf/advanced/threading-model.md" title="1 Contributor" aria-label="1 Contributor">
									<ul class="contributors" data-bi-name="contributors" aria-hidden="true">
												<li><img src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/adegeo.png" data-src="https://github.com/adegeo.png?size=32" role="presentation"></li>
									</ul>
										</a>
								</li>
						</ul>

						<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
							<h3>In this article</h3>
						<ol><li><a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#overview-and-the-dispatcher">Overview and the Dispatcher</a></li><li><a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#threads-in-action-the-samples">Threads in Action: The Samples</a></li><li><a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#technical-details-and-stumbling-points">Technical Details and Stumbling Points</a></li><li><a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#see-also">See also</a></li></ol></nav>

						<!-- <content> -->
							<p>Windows Presentation Foundation (WPF) is designed to save developers from the difficulties of threading. As a result, the majority of WPF developers won't have to write an interface that uses more than one thread. Because multithreaded programs are complex and difficult to debug, they should be avoided when single-threaded solutions exist.</p>
<p>No matter how well architected, however, no UI framework will ever be able to provide a single-threaded solution for every sort of problem. WPF comes close, but there are still situations where multiple threads improve user interface (UI) responsiveness or application performance. After discussing some background material, this paper explores some of these situations and then concludes with a discussion of some lower-level details.</p>
<div class="alert is-info">
<p class="alert-title"><span class="docon docon-status-error-outline" aria-hidden="true"></span> Note</p>
<p>This topic discusses threading by using the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.begininvoke" data-linktype="absolute-path">BeginInvoke</a> method for asynchronous calls. You can also make asynchronous calls by calling the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.invokeasync" data-linktype="absolute-path">InvokeAsync</a> method, which take an <a href="https://docs.microsoft.com/en-us/dotnet/api/system.action" data-linktype="absolute-path">Action</a> or <a href="https://docs.microsoft.com/en-us/dotnet/api/system.func-1" data-linktype="absolute-path">Func&lt;TResult&gt;</a> as a parameter.  The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.invokeasync" data-linktype="absolute-path">InvokeAsync</a> method returns a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcheroperation" data-linktype="absolute-path">DispatcherOperation</a> or <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcheroperation-1" data-linktype="absolute-path">DispatcherOperation&lt;TResult&gt;</a>, which has a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcheroperation.task" data-linktype="absolute-path">Task</a> property. You can use the <code>await</code> keyword with either the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcheroperation" data-linktype="absolute-path">DispatcherOperation</a> or the associated <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task" data-linktype="absolute-path">Task</a>. If you need to wait synchronously for the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task" data-linktype="absolute-path">Task</a> that is returned by a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcheroperation" data-linktype="absolute-path">DispatcherOperation</a> or <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcheroperation-1" data-linktype="absolute-path">DispatcherOperation&lt;TResult&gt;</a>, call the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.taskextensions.dispatcheroperationwait" data-linktype="absolute-path">DispatcherOperationWait</a> extension method.  Calling <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task.wait" data-linktype="absolute-path">Task.Wait</a> will result in a deadlock. For more information about using a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task" data-linktype="absolute-path">Task</a> to perform asynchronous operations, see Task Parallelism.  The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.invoke" data-linktype="absolute-path">Invoke</a> method also has overloads that take an <a href="https://docs.microsoft.com/en-us/dotnet/api/system.action" data-linktype="absolute-path">Action</a> or <a href="https://docs.microsoft.com/en-us/dotnet/api/system.func-1" data-linktype="absolute-path">Func&lt;TResult&gt;</a> as a parameter.  You can use the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.invoke" data-linktype="absolute-path">Invoke</a> method to make synchronous calls by passing in a delegate, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.action" data-linktype="absolute-path">Action</a> or <a href="https://docs.microsoft.com/en-us/dotnet/api/system.func-1" data-linktype="absolute-path">Func&lt;TResult&gt;</a>.</p>
</div>
<p><a name="threading_overview"></a></p>
<h2 id="overview-and-the-dispatcher" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#overview-and-the-dispatcher" aria-labelledby="overview-and-the-dispatcher"></a>Overview and the Dispatcher</h2>
<p>Typically, WPF applications start with two threads: one for handling rendering and another for managing the UI. The rendering thread effectively runs hidden in the background while the UI thread receives input, handles events, paints the screen, and runs application code. Most applications use a single UI thread, although in some situations it is best to use several. We’ll discuss this with an example later.</p>
<p>The UI thread queues work items inside an object called a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a>. The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> selects work items on a priority basis and runs each one to completion.  Every UI thread must have at least one <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a>, and each <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> can execute work items in exactly one thread.</p>
<p>The trick to building responsive, user-friendly applications is to maximize the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> throughput by keeping the work items small. This way items never get stale sitting in the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> queue waiting for processing. Any perceivable delay between input and response can frustrate a user.</p>
<p>How then are WPF applications supposed to handle big operations? What if your code involves a large calculation or needs to query a database on some remote server? Usually, the answer is to handle the big operation in a separate thread, leaving the UI thread free to tend to items in the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> queue. When the big operation is complete, it can report its result back to the UI thread for display.</p>
<p>Historically, Windows allows UI elements to be accessed only by the thread that created them. This means that a background thread in charge of some long-running task cannot update a text box when it is finished. Windows does this to ensure the integrity of UI components. A list box could look strange if its contents were updated by a background thread during painting.</p>
<p>WPF has a built-in mutual exclusion mechanism that enforces this coordination. Most classes in WPF derive from <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject" data-linktype="absolute-path">DispatcherObject</a>. At construction, a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject" data-linktype="absolute-path">DispatcherObject</a> stores a reference to the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> linked to the currently running thread. In effect, the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject" data-linktype="absolute-path">DispatcherObject</a> associates with the thread that creates it. During program execution, a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject" data-linktype="absolute-path">DispatcherObject</a> can call its public <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject.verifyaccess" data-linktype="absolute-path">VerifyAccess</a> method. <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject.verifyaccess" data-linktype="absolute-path">VerifyAccess</a> examines the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> associated with the current thread and compares it to the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> reference stored during construction. If they don’t match, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject.verifyaccess" data-linktype="absolute-path">VerifyAccess</a> throws an exception. <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject.verifyaccess" data-linktype="absolute-path">VerifyAccess</a> is intended to be called at the beginning of every method belonging to a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject" data-linktype="absolute-path">DispatcherObject</a>.</p>
<p>If only one thread can modify the UI, how do background threads interact with the user? A background thread can ask the UI thread to perform an operation on its behalf. It does this by registering a work item with the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> of the UI thread. The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> class provides two methods for registering work items: <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.invoke" data-linktype="absolute-path">Invoke</a> and <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.begininvoke" data-linktype="absolute-path">BeginInvoke</a>. Both methods schedule a delegate for execution. <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.invoke" data-linktype="absolute-path">Invoke</a> is a synchronous call – that is, it doesn’t return until the UI thread actually finishes executing the delegate. <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.begininvoke" data-linktype="absolute-path">BeginInvoke</a> is asynchronous and returns immediately.</p>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> orders the elements in its queue by priority. There are ten levels that may be specified when adding an element to the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> queue. These priorities are maintained in the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherpriority" data-linktype="absolute-path">DispatcherPriority</a> enumeration. Detailed information about <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherpriority" data-linktype="absolute-path">DispatcherPriority</a> levels can be found in the Windows SDK documentation.</p>
<p><a name="samples"></a></p>
<h2 id="threads-in-action-the-samples" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#threads-in-action-the-samples" aria-labelledby="threads-in-action-the-samples"></a>Threads in Action: The Samples</h2>
<p><a name="prime_number"></a></p>
<h3 id="a-single-threaded-application-with-a-long-running-calculation" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#a-single-threaded-application-with-a-long-running-calculation" aria-labelledby="a-single-threaded-application-with-a-long-running-calculation"></a>A Single-Threaded Application with a Long-Running Calculation</h3>
<p>Most graphical user interfaces (GUIs) spend a large portion of their time idle while waiting for events that are generated in response to user interactions. With careful programming this idle time can be used constructively, without affecting the responsiveness of the UI. The WPF threading model doesn’t allow input to interrupt an operation happening in the UI thread. This means you must be sure to return to the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> periodically to process pending input events before they get stale.</p>
<p>Consider the following example:</p>
<p><img src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/threading-prime-numbers.png" alt="Screenshot that shows threading of prime numbers." data-linktype="relative-path"></p>
<p>This simple application counts upwards from three, searching for prime numbers. When the user clicks the <strong>Start</strong> button, the search begins. When the program finds a prime, it updates the user interface with its discovery. At any point, the user can stop the search.</p>
<p>Although simple enough, the prime number search could go on forever, which presents some difficulties.  If we handled the entire search inside of the click event handler of the button, we would never give the UI thread a chance to handle other events. The UI would be unable to respond to input or process messages. It would never repaint and never respond to button clicks.</p>
<p>We could conduct the prime number search in a separate thread, but then we would need to deal with synchronization issues. With a single-threaded approach, we can directly update the label that lists the largest prime found.</p>
<p>If we break up the task of calculation into manageable chunks, we can periodically return to the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> and process events. We can give WPF an opportunity to repaint and process input.</p>
<p>The best way to split processing time between calculation and event handling is to manage calculation from the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a>. By using the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.begininvoke" data-linktype="absolute-path">BeginInvoke</a> method, we can schedule prime number checks in the same queue that UI events are drawn from. In our example, we schedule only a single prime number check at a time. After the prime number check is complete, we schedule the next check immediately. This check proceeds only after pending UI events have been handled.</p>
<p><img src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/threading-dispatcher-queue.png" alt="Screenshot that shows the dispatcher queue." data-linktype="relative-path"></p>
<p>Microsoft Word accomplishes spell checking using this mechanism. Spell checking is done in the background using the idle time of the UI thread. Let's take a look at the code.</p>
<p>The following example shows the XAML that creates the user interface.</p>
<div class="codeHeader" id="code-try-0" data-bi-name="code-header"><span class="language">XAML</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-xaml" name="ThreadingPrimeNumbers#ThreadingPrimeNumberXAML" data-author-content="&lt;Window x:Class=&quot;SDKSamples.Window1&quot;
    xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
    xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
    Title=&quot;Prime Numbers&quot; Width=&quot;260&quot; Height=&quot;75&quot;
    &gt;
  &lt;StackPanel Orientation=&quot;Horizontal&quot; VerticalAlignment=&quot;Center&quot; &gt;
    &lt;Button Content=&quot;Start&quot;  
            Click=&quot;StartOrStop&quot;
            Name=&quot;startStopButton&quot;
            Margin=&quot;5,0,5,0&quot;
            /&gt;
    &lt;TextBlock Margin=&quot;10,5,0,0&quot;&gt;Biggest Prime Found:&lt;/TextBlock&gt;
    &lt;TextBlock Name=&quot;bigPrime&quot; Margin=&quot;4,5,0,0&quot;&gt;3&lt;/TextBlock&gt;
  &lt;/StackPanel&gt;
&lt;/Window&gt;
"><span><span class="hljs-tag">&lt;<span class="hljs-name">Window</span> <span class="hljs-attr">x:Class</span>=<span class="hljs-string">"SDKSamples.Window1"</span>
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
    <span class="hljs-attr">xmlns:x</span>=<span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
    <span class="hljs-attr">Title</span>=<span class="hljs-string">"Prime Numbers"</span> <span class="hljs-attr">Width</span>=<span class="hljs-string">"260"</span> <span class="hljs-attr">Height</span>=<span class="hljs-string">"75"</span>
    &gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">StackPanel</span> <span class="hljs-attr">Orientation</span>=<span class="hljs-string">"Horizontal"</span> <span class="hljs-attr">VerticalAlignment</span>=<span class="hljs-string">"Center"</span> &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">Content</span>=<span class="hljs-string">"Start"</span>  
            <span class="hljs-attr">Click</span>=<span class="hljs-string">"StartOrStop"</span>
            <span class="hljs-attr">Name</span>=<span class="hljs-string">"startStopButton"</span>
            <span class="hljs-attr">Margin</span>=<span class="hljs-string">"5,0,5,0"</span>
            /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TextBlock</span> <span class="hljs-attr">Margin</span>=<span class="hljs-string">"10,5,0,0"</span>&gt;</span>Biggest Prime Found:<span class="hljs-tag">&lt;/<span class="hljs-name">TextBlock</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TextBlock</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">"bigPrime"</span> <span class="hljs-attr">Margin</span>=<span class="hljs-string">"4,5,0,0"</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">TextBlock</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">StackPanel</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Window</span>&gt;</span>
</span></code></pre>
<p>The following example shows the code-behind.</p>
<div class="codeHeader" id="code-try-1" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingPrimeNumbers#ThreadingPrimeNumberCodeBehind" data-author-content="using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Threading;
using System.Threading;

namespace SDKSamples
{
    public partial class Window1 : Window
    {
        public delegate void NextPrimeDelegate();

        //Current number to check
        private long num = 3;

        private bool continueCalculating = false;

        public Window1() : base()
        {
            InitializeComponent();
        }

        private void StartOrStop(object sender, EventArgs e)
        {
            if (continueCalculating)
            {
                continueCalculating = false;
                startStopButton.Content = &quot;Resume&quot;;
            }
            else
            {
                continueCalculating = true;
                startStopButton.Content = &quot;Stop&quot;;
                startStopButton.Dispatcher.BeginInvoke(
                    DispatcherPriority.Normal,
                    new NextPrimeDelegate(CheckNextNumber));
            }
        }

        public void CheckNextNumber()
        {
            // Reset flag.
            NotAPrime = false;

            for (long i = 3; i &lt;= Math.Sqrt(num); i++)
            {
                if (num % i == 0)
                {
                    // Set not a prime flag to true.
                    NotAPrime = true;
                    break;
                }
            }

            // If a prime number.
            if (!NotAPrime)
            {
                bigPrime.Text = num.ToString();
            }

            num += 2;
            if (continueCalculating)
            {
                startStopButton.Dispatcher.BeginInvoke(
                    System.Windows.Threading.DispatcherPriority.SystemIdle,
                    new NextPrimeDelegate(this.CheckNextNumber));
            }
        }

        private bool NotAPrime = false;
    }
}
"><span><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Windows;
<span class="hljs-keyword">using</span> System.Windows.Controls;
<span class="hljs-keyword">using</span> System.Windows.Threading;
<span class="hljs-keyword">using</span> System.Threading;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">SDKSamples</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Window1</span> : <span class="hljs-title">Window</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">NextPrimeDelegate</span>(<span class="hljs-params"></span>)</span>;

        <span class="hljs-comment">//Current number to check</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> num = <span class="hljs-number">3</span>;

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> continueCalculating = <span class="hljs-literal">false</span>;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Window1</span>(<span class="hljs-params"></span>) : <span class="hljs-title">base</span>(<span class="hljs-params"></span>)</span>
        {
            InitializeComponent();
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">StartOrStop</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, EventArgs e</span>)</span>
        {
            <span class="hljs-keyword">if</span> (continueCalculating)
            {
                continueCalculating = <span class="hljs-literal">false</span>;
                startStopButton.Content = <span class="hljs-string">"Resume"</span>;
            }
            <span class="hljs-keyword">else</span>
            {
                continueCalculating = <span class="hljs-literal">true</span>;
                startStopButton.Content = <span class="hljs-string">"Stop"</span>;
                startStopButton.Dispatcher.BeginInvoke(
                    DispatcherPriority.Normal,
                    <span class="hljs-keyword">new</span> NextPrimeDelegate(CheckNextNumber));
            }
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CheckNextNumber</span>(<span class="hljs-params"></span>)</span>
        {
            <span class="hljs-comment">// Reset flag.</span>
            NotAPrime = <span class="hljs-literal">false</span>;

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">long</span> i = <span class="hljs-number">3</span>; i &lt;= Math.Sqrt(num); i++)
            {
                <span class="hljs-keyword">if</span> (num % i == <span class="hljs-number">0</span>)
                {
                    <span class="hljs-comment">// Set not a prime flag to true.</span>
                    NotAPrime = <span class="hljs-literal">true</span>;
                    <span class="hljs-keyword">break</span>;
                }
            }

            <span class="hljs-comment">// If a prime number.</span>
            <span class="hljs-keyword">if</span> (!NotAPrime)
            {
                bigPrime.Text = num.ToString();
            }

            num += <span class="hljs-number">2</span>;
            <span class="hljs-keyword">if</span> (continueCalculating)
            {
                startStopButton.Dispatcher.BeginInvoke(
                    System.Windows.Threading.DispatcherPriority.SystemIdle,
                    <span class="hljs-keyword">new</span> NextPrimeDelegate(<span class="hljs-keyword">this</span>.CheckNextNumber));
            }
        }

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> NotAPrime = <span class="hljs-literal">false</span>;
    }
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingPrimeNumbers#ThreadingPrimeNumberCodeBehind" data-author-content="Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Threading
Imports System.Threading

Namespace SDKSamples
    Partial Public Class MainWindow
        Inherits Window
        Public Delegate Sub NextPrimeDelegate()

        &#39;Current number to check 
        Private num As Long = 3

        Private continueCalculating As Boolean = False

        Public Sub New()
            MyBase.New()
            InitializeComponent()
        End Sub

        Private Sub StartOrStop(ByVal sender As Object, ByVal e As EventArgs)
            If continueCalculating Then
                continueCalculating = False
                startStopButton.Content = &quot;Resume&quot;
            Else
                continueCalculating = True
                startStopButton.Content = &quot;Stop&quot;
                startStopButton.Dispatcher.BeginInvoke(DispatcherPriority.Normal, New NextPrimeDelegate(AddressOf CheckNextNumber))
            End If
        End Sub

        Public Sub CheckNextNumber()
            &#39; Reset flag.
            NotAPrime = False

            For i As Long = 3 To Math.Sqrt(num)
                If num Mod i = 0 Then
                    &#39; Set not a prime flag to true.
                    NotAPrime = True
                    Exit For
                End If
            Next

            &#39; If a prime number.
            If Not NotAPrime Then
                bigPrime.Text = num.ToString()
            End If

            num += 2
            If continueCalculating Then
                startStopButton.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.SystemIdle, New NextPrimeDelegate(AddressOf Me.CheckNextNumber))
            End If
        End Sub

        Private NotAPrime As Boolean = False
    End Class
End Namespace
">Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Threading
Imports System.Threading

Namespace SDKSamples
    Partial Public Class MainWindow
        Inherits Window
        Public Delegate Sub NextPrimeDelegate()

        'Current number to check 
        Private num As Long = 3

        Private continueCalculating As Boolean = False

        Public Sub New()
            MyBase.New()
            InitializeComponent()
        End Sub

        Private Sub StartOrStop(ByVal sender As Object, ByVal e As EventArgs)
            If continueCalculating Then
                continueCalculating = False
                startStopButton.Content = "Resume"
            Else
                continueCalculating = True
                startStopButton.Content = "Stop"
                startStopButton.Dispatcher.BeginInvoke(DispatcherPriority.Normal, New NextPrimeDelegate(AddressOf CheckNextNumber))
            End If
        End Sub

        Public Sub CheckNextNumber()
            ' Reset flag.
            NotAPrime = False

            For i As Long = 3 To Math.Sqrt(num)
                If num Mod i = 0 Then
                    ' Set not a prime flag to true.
                    NotAPrime = True
                    Exit For
                End If
            Next

            ' If a prime number.
            If Not NotAPrime Then
                bigPrime.Text = num.ToString()
            End If

            num += 2
            If continueCalculating Then
                startStopButton.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.SystemIdle, New NextPrimeDelegate(AddressOf Me.CheckNextNumber))
            End If
        End Sub

        Private NotAPrime As Boolean = False
    End Class
End Namespace
</code></pre>
<p>The following example shows the event handler for the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.button" data-linktype="absolute-path">Button</a>.</p>
<div class="codeHeader" id="code-try-2" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingPrimeNumbers#ThreadingPrimeNumberStartOrStop" data-author-content="private void StartOrStop(object sender, EventArgs e)
{
    if (continueCalculating)
    {
        continueCalculating = false;
        startStopButton.Content = &quot;Resume&quot;;
    }
    else
    {
        continueCalculating = true;
        startStopButton.Content = &quot;Stop&quot;;
        startStopButton.Dispatcher.BeginInvoke(
            DispatcherPriority.Normal,
            new NextPrimeDelegate(CheckNextNumber));
    }
}
"><span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">StartOrStop</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, EventArgs e</span>)</span>
{
    <span class="hljs-keyword">if</span> (continueCalculating)
    {
        continueCalculating = <span class="hljs-literal">false</span>;
        startStopButton.Content = <span class="hljs-string">"Resume"</span>;
    }
    <span class="hljs-keyword">else</span>
    {
        continueCalculating = <span class="hljs-literal">true</span>;
        startStopButton.Content = <span class="hljs-string">"Stop"</span>;
        startStopButton.Dispatcher.BeginInvoke(
            DispatcherPriority.Normal,
            <span class="hljs-keyword">new</span> NextPrimeDelegate(CheckNextNumber));
    }
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingPrimeNumbers#ThreadingPrimeNumberStartOrStop" data-author-content="Private Sub StartOrStop(ByVal sender As Object, ByVal e As EventArgs)
    If continueCalculating Then
        continueCalculating = False
        startStopButton.Content = &quot;Resume&quot;
    Else
        continueCalculating = True
        startStopButton.Content = &quot;Stop&quot;
        startStopButton.Dispatcher.BeginInvoke(DispatcherPriority.Normal, New NextPrimeDelegate(AddressOf CheckNextNumber))
    End If
End Sub
">Private Sub StartOrStop(ByVal sender As Object, ByVal e As EventArgs)
    If continueCalculating Then
        continueCalculating = False
        startStopButton.Content = "Resume"
    Else
        continueCalculating = True
        startStopButton.Content = "Stop"
        startStopButton.Dispatcher.BeginInvoke(DispatcherPriority.Normal, New NextPrimeDelegate(AddressOf CheckNextNumber))
    End If
End Sub
</code></pre>
<p>Besides updating the text on the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.button" data-linktype="absolute-path">Button</a>, this handler is responsible for scheduling the first prime number check by adding a delegate to the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> queue. Sometime after this event handler has completed its work, the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> will select this delegate for execution.</p>
<p>As we mentioned earlier, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.begininvoke" data-linktype="absolute-path">BeginInvoke</a> is the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> member used to schedule a delegate for execution. In this case, we choose the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherpriority#System_Windows_Threading_DispatcherPriority_SystemIdle" data-linktype="absolute-path">SystemIdle</a> priority. The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> will execute this delegate only when there are no important events to process. UI responsiveness is more important than number checking. We also pass a new delegate representing the number-checking routine.</p>
<div class="codeHeader" id="code-try-3" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingPrimeNumbers#ThreadingPrimeNumberCheckNextNumber" data-author-content="public void CheckNextNumber()
{
    // Reset flag.
    NotAPrime = false;

    for (long i = 3; i &lt;= Math.Sqrt(num); i++)
    {
        if (num % i == 0)
        {
            // Set not a prime flag to true.
            NotAPrime = true;
            break;
        }
    }

    // If a prime number.
    if (!NotAPrime)
    {
        bigPrime.Text = num.ToString();
    }

    num += 2;
    if (continueCalculating)
    {
        startStopButton.Dispatcher.BeginInvoke(
            System.Windows.Threading.DispatcherPriority.SystemIdle,
            new NextPrimeDelegate(this.CheckNextNumber));
    }
}

private bool NotAPrime = false;
"><span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CheckNextNumber</span>(<span class="hljs-params"></span>)</span>
{
    <span class="hljs-comment">// Reset flag.</span>
    NotAPrime = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">long</span> i = <span class="hljs-number">3</span>; i &lt;= Math.Sqrt(num); i++)
    {
        <span class="hljs-keyword">if</span> (num % i == <span class="hljs-number">0</span>)
        {
            <span class="hljs-comment">// Set not a prime flag to true.</span>
            NotAPrime = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">break</span>;
        }
    }

    <span class="hljs-comment">// If a prime number.</span>
    <span class="hljs-keyword">if</span> (!NotAPrime)
    {
        bigPrime.Text = num.ToString();
    }

    num += <span class="hljs-number">2</span>;
    <span class="hljs-keyword">if</span> (continueCalculating)
    {
        startStopButton.Dispatcher.BeginInvoke(
            System.Windows.Threading.DispatcherPriority.SystemIdle,
            <span class="hljs-keyword">new</span> NextPrimeDelegate(<span class="hljs-keyword">this</span>.CheckNextNumber));
    }
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> NotAPrime = <span class="hljs-literal">false</span>;
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingPrimeNumbers#ThreadingPrimeNumberCheckNextNumber" data-author-content="Public Sub CheckNextNumber()
    &#39; Reset flag.
    NotAPrime = False

    For i As Long = 3 To Math.Sqrt(num)
        If num Mod i = 0 Then
            &#39; Set not a prime flag to true.
            NotAPrime = True
            Exit For
        End If
    Next

    &#39; If a prime number.
    If Not NotAPrime Then
        bigPrime.Text = num.ToString()
    End If

    num += 2
    If continueCalculating Then
        startStopButton.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.SystemIdle, New NextPrimeDelegate(AddressOf Me.CheckNextNumber))
    End If
End Sub

Private NotAPrime As Boolean = False
">Public Sub CheckNextNumber()
    ' Reset flag.
    NotAPrime = False

    For i As Long = 3 To Math.Sqrt(num)
        If num Mod i = 0 Then
            ' Set not a prime flag to true.
            NotAPrime = True
            Exit For
        End If
    Next

    ' If a prime number.
    If Not NotAPrime Then
        bigPrime.Text = num.ToString()
    End If

    num += 2
    If continueCalculating Then
        startStopButton.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.SystemIdle, New NextPrimeDelegate(AddressOf Me.CheckNextNumber))
    End If
End Sub

Private NotAPrime As Boolean = False
</code></pre>
<p>This method checks if the next odd number is prime. If it is prime, the method directly updates the <code>bigPrime</code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textblock" data-linktype="absolute-path">TextBlock</a> to reflect its discovery. We can do this because the calculation is occurring in the same thread that was used to create the component. Had we chosen to use a separate thread for the calculation, we would have to use a more complicated synchronization mechanism and execute the update in the UI thread. We’ll demonstrate this situation next.</p>
<p>For the complete source code for this sample, see the <a href="https://github.com/Microsoft/WPF-Samples/tree/master/Threading/SingleThreadedApplication" data-linktype="external">Single-Threaded Application with Long-Running Calculation Sample</a></p>
<p><a name="weather_sim"></a></p>
<h3 id="handling-a-blocking-operation-with-a-background-thread" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#handling-a-blocking-operation-with-a-background-thread" aria-labelledby="handling-a-blocking-operation-with-a-background-thread"></a>Handling a Blocking Operation with a Background Thread</h3>
<p>Handling blocking operations in a graphical application can be difficult. We don’t want to call blocking methods from event handlers because the application will appear to freeze up. We can use a separate thread to handle these operations, but when we’re done, we have to synchronize with the UI thread because we can’t directly modify the GUI from our worker thread. We can use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.invoke" data-linktype="absolute-path">Invoke</a> or <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.begininvoke" data-linktype="absolute-path">BeginInvoke</a> to insert delegates into the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> of the UI thread. Eventually, these delegates will be executed with permission to modify UI elements.</p>
<p>In this example, we mimic a remote procedure call that retrieves a weather forecast. We use a separate worker thread to execute this call, and we schedule an update method in the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> of the UI thread when we’re finished.</p>
<p><img src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/threading-weather-ui.png" alt="Screenshot that shows the weather UI." data-linktype="relative-path"></p>
<div class="codeHeader" id="code-try-4" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingWeatherForecast#ThreadingWeatherCodeBehind" data-author-content="using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;
using System.Windows.Threading;
using System.Threading;

namespace SDKSamples
{
    public partial class Window1 : Window
    {
        // Delegates to be used in placking jobs onto the Dispatcher.
        private delegate void NoArgDelegate();
        private delegate void OneArgDelegate(String arg);

        // Storyboards for the animations.
        private Storyboard showClockFaceStoryboard;
        private Storyboard hideClockFaceStoryboard;
        private Storyboard showWeatherImageStoryboard;
        private Storyboard hideWeatherImageStoryboard;

        public Window1(): base()
        {
            InitializeComponent();
        }

        private void Window_Loaded(object sender, RoutedEventArgs e)
        {
            // Load the storyboard resources.
            showClockFaceStoryboard =
                (Storyboard)this.Resources[&quot;ShowClockFaceStoryboard&quot;];
            hideClockFaceStoryboard =
                (Storyboard)this.Resources[&quot;HideClockFaceStoryboard&quot;];
            showWeatherImageStoryboard =
                (Storyboard)this.Resources[&quot;ShowWeatherImageStoryboard&quot;];
            hideWeatherImageStoryboard =
                (Storyboard)this.Resources[&quot;HideWeatherImageStoryboard&quot;];
        }

        private void ForecastButtonHandler(object sender, RoutedEventArgs e)
        {
            // Change the status image and start the rotation animation.
            fetchButton.IsEnabled = false;
            fetchButton.Content = &quot;Contacting Server&quot;;
            weatherText.Text = &quot;&quot;;
            hideWeatherImageStoryboard.Begin(this);

            // Start fetching the weather forecast asynchronously.
            NoArgDelegate fetcher = new NoArgDelegate(
                this.FetchWeatherFromServer);

            fetcher.BeginInvoke(null, null);
        }

        private void FetchWeatherFromServer()
        {
            // Simulate the delay from network access.
            Thread.Sleep(4000);

            // Tried and true method for weather forecasting - random numbers.
            Random rand = new Random();
            String weather;

            if (rand.Next(2) == 0)
            {
                weather = &quot;rainy&quot;;
            }
            else
            {
                weather = &quot;sunny&quot;;
            }

            // Schedule the update function in the UI thread.
            tomorrowsWeather.Dispatcher.BeginInvoke(
                System.Windows.Threading.DispatcherPriority.Normal,
                new OneArgDelegate(UpdateUserInterface),
                weather);
        }

        private void UpdateUserInterface(String weather)
        {
            //Set the weather image
            if (weather == &quot;sunny&quot;)
            {
                weatherIndicatorImage.Source = (ImageSource)this.Resources[
                    &quot;SunnyImageSource&quot;];
            }
            else if (weather == &quot;rainy&quot;)
            {
                weatherIndicatorImage.Source = (ImageSource)this.Resources[
                    &quot;RainingImageSource&quot;];
            }

            //Stop clock animation
            showClockFaceStoryboard.Stop(this);
            hideClockFaceStoryboard.Begin(this);

            //Update UI text
            fetchButton.IsEnabled = true;
            fetchButton.Content = &quot;Fetch Forecast&quot;;
            weatherText.Text = weather;
        }

        private void HideClockFaceStoryboard_Completed(object sender,
            EventArgs args)
        {
            showWeatherImageStoryboard.Begin(this);
        }

        private void HideWeatherImageStoryboard_Completed(object sender,
            EventArgs args)
        {
            showClockFaceStoryboard.Begin(this, true);
        }
    }
}
"><span><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Windows;
<span class="hljs-keyword">using</span> System.Windows.Controls;
<span class="hljs-keyword">using</span> System.Windows.Media;
<span class="hljs-keyword">using</span> System.Windows.Media.Animation;
<span class="hljs-keyword">using</span> System.Windows.Media.Imaging;
<span class="hljs-keyword">using</span> System.Windows.Shapes;
<span class="hljs-keyword">using</span> System.Windows.Threading;
<span class="hljs-keyword">using</span> System.Threading;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">SDKSamples</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Window1</span> : <span class="hljs-title">Window</span>
    {
        <span class="hljs-comment">// Delegates to be used in placking jobs onto the Dispatcher.</span>
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">NoArgDelegate</span>(<span class="hljs-params"></span>)</span>;
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OneArgDelegate</span>(<span class="hljs-params">String arg</span>)</span>;

        <span class="hljs-comment">// Storyboards for the animations.</span>
        <span class="hljs-keyword">private</span> Storyboard showClockFaceStoryboard;
        <span class="hljs-keyword">private</span> Storyboard hideClockFaceStoryboard;
        <span class="hljs-keyword">private</span> Storyboard showWeatherImageStoryboard;
        <span class="hljs-keyword">private</span> Storyboard hideWeatherImageStoryboard;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Window1</span>(<span class="hljs-params"></span>): <span class="hljs-title">base</span>(<span class="hljs-params"></span>)</span>
        {
            InitializeComponent();
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Window_Loaded</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, RoutedEventArgs e</span>)</span>
        {
            <span class="hljs-comment">// Load the storyboard resources.</span>
            showClockFaceStoryboard =
                (Storyboard)<span class="hljs-keyword">this</span>.Resources[<span class="hljs-string">"ShowClockFaceStoryboard"</span>];
            hideClockFaceStoryboard =
                (Storyboard)<span class="hljs-keyword">this</span>.Resources[<span class="hljs-string">"HideClockFaceStoryboard"</span>];
            showWeatherImageStoryboard =
                (Storyboard)<span class="hljs-keyword">this</span>.Resources[<span class="hljs-string">"ShowWeatherImageStoryboard"</span>];
            hideWeatherImageStoryboard =
                (Storyboard)<span class="hljs-keyword">this</span>.Resources[<span class="hljs-string">"HideWeatherImageStoryboard"</span>];
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ForecastButtonHandler</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, RoutedEventArgs e</span>)</span>
        {
            <span class="hljs-comment">// Change the status image and start the rotation animation.</span>
            fetchButton.IsEnabled = <span class="hljs-literal">false</span>;
            fetchButton.Content = <span class="hljs-string">"Contacting Server"</span>;
            weatherText.Text = <span class="hljs-string">""</span>;
            hideWeatherImageStoryboard.Begin(<span class="hljs-keyword">this</span>);

            <span class="hljs-comment">// Start fetching the weather forecast asynchronously.</span>
            NoArgDelegate fetcher = <span class="hljs-keyword">new</span> NoArgDelegate(
                <span class="hljs-keyword">this</span>.FetchWeatherFromServer);

            fetcher.BeginInvoke(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FetchWeatherFromServer</span>(<span class="hljs-params"></span>)</span>
        {
            <span class="hljs-comment">// Simulate the delay from network access.</span>
            Thread.Sleep(<span class="hljs-number">4000</span>);

            <span class="hljs-comment">// Tried and true method for weather forecasting - random numbers.</span>
            Random rand = <span class="hljs-keyword">new</span> Random();
            String weather;

            <span class="hljs-keyword">if</span> (rand.Next(<span class="hljs-number">2</span>) == <span class="hljs-number">0</span>)
            {
                weather = <span class="hljs-string">"rainy"</span>;
            }
            <span class="hljs-keyword">else</span>
            {
                weather = <span class="hljs-string">"sunny"</span>;
            }

            <span class="hljs-comment">// Schedule the update function in the UI thread.</span>
            tomorrowsWeather.Dispatcher.BeginInvoke(
                System.Windows.Threading.DispatcherPriority.Normal,
                <span class="hljs-keyword">new</span> OneArgDelegate(UpdateUserInterface),
                weather);
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateUserInterface</span>(<span class="hljs-params">String weather</span>)</span>
        {
            <span class="hljs-comment">//Set the weather image</span>
            <span class="hljs-keyword">if</span> (weather == <span class="hljs-string">"sunny"</span>)
            {
                weatherIndicatorImage.Source = (ImageSource)<span class="hljs-keyword">this</span>.Resources[
                    <span class="hljs-string">"SunnyImageSource"</span>];
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (weather == <span class="hljs-string">"rainy"</span>)
            {
                weatherIndicatorImage.Source = (ImageSource)<span class="hljs-keyword">this</span>.Resources[
                    <span class="hljs-string">"RainingImageSource"</span>];
            }

            <span class="hljs-comment">//Stop clock animation</span>
            showClockFaceStoryboard.Stop(<span class="hljs-keyword">this</span>);
            hideClockFaceStoryboard.Begin(<span class="hljs-keyword">this</span>);

            <span class="hljs-comment">//Update UI text</span>
            fetchButton.IsEnabled = <span class="hljs-literal">true</span>;
            fetchButton.Content = <span class="hljs-string">"Fetch Forecast"</span>;
            weatherText.Text = weather;
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HideClockFaceStoryboard_Completed</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender,
            EventArgs args</span>)</span>
        {
            showWeatherImageStoryboard.Begin(<span class="hljs-keyword">this</span>);
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HideWeatherImageStoryboard_Completed</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender,
            EventArgs args</span>)</span>
        {
            showClockFaceStoryboard.Begin(<span class="hljs-keyword">this</span>, <span class="hljs-literal">true</span>);
        }
    }
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingWeatherForecast#ThreadingWeatherCodeBehind" data-author-content="
Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Media
Imports System.Windows.Media.Animation
Imports System.Windows.Media.Imaging
Imports System.Windows.Shapes
Imports System.Windows.Threading
Imports System.Threading

Namespace SDKSamples
    Partial Public Class Window1
        Inherits Window
        &#39; Delegates to be used in placking jobs onto the Dispatcher.
        Private Delegate Sub NoArgDelegate()
        Private Delegate Sub OneArgDelegate(ByVal arg As String)

        &#39; Storyboards for the animations.
        Private showClockFaceStoryboard As Storyboard
        Private hideClockFaceStoryboard As Storyboard
        Private showWeatherImageStoryboard As Storyboard
        Private hideWeatherImageStoryboard As Storyboard

        Public Sub New()
            MyBase.New()
            InitializeComponent()
        End Sub

        Private Sub Window_Loaded(ByVal sender As Object, ByVal e As RoutedEventArgs)
            &#39; Load the storyboard resources.
            showClockFaceStoryboard = CType(Me.Resources(&quot;ShowClockFaceStoryboard&quot;), Storyboard)
            hideClockFaceStoryboard = CType(Me.Resources(&quot;HideClockFaceStoryboard&quot;), Storyboard)
            showWeatherImageStoryboard = CType(Me.Resources(&quot;ShowWeatherImageStoryboard&quot;), Storyboard)
            hideWeatherImageStoryboard = CType(Me.Resources(&quot;HideWeatherImageStoryboard&quot;), Storyboard)
        End Sub

        Private Sub ForecastButtonHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)
            &#39; Change the status image and start the rotation animation.
            fetchButton.IsEnabled = False
            fetchButton.Content = &quot;Contacting Server&quot;
            weatherText.Text = &quot;&quot;
            hideWeatherImageStoryboard.Begin(Me)

            &#39; Start fetching the weather forecast asynchronously.
            Dim fetcher As New NoArgDelegate(AddressOf Me.FetchWeatherFromServer)

            fetcher.BeginInvoke(Nothing, Nothing)
        End Sub

        Private Sub FetchWeatherFromServer()
            &#39; Simulate the delay from network access.
            Thread.Sleep(4000)

            &#39; Tried and true method for weather forecasting - random numbers.
            Dim rand As New Random()
            Dim weather As String

            If rand.Next(2) = 0 Then
                weather = &quot;rainy&quot;
            Else
                weather = &quot;sunny&quot;
            End If

            &#39; Schedule the update function in the UI thread.
            tomorrowsWeather.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.Normal, New OneArgDelegate(AddressOf UpdateUserInterface), weather)
        End Sub

        Private Sub UpdateUserInterface(ByVal weather As String)
            &#39;Set the weather image
            If weather = &quot;sunny&quot; Then
                weatherIndicatorImage.Source = CType(Me.Resources(&quot;SunnyImageSource&quot;), ImageSource)
            ElseIf weather = &quot;rainy&quot; Then
                weatherIndicatorImage.Source = CType(Me.Resources(&quot;RainingImageSource&quot;), ImageSource)
            End If

            &#39;Stop clock animation
            showClockFaceStoryboard.Stop(Me)
            hideClockFaceStoryboard.Begin(Me)

            &#39;Update UI text
            fetchButton.IsEnabled = True
            fetchButton.Content = &quot;Fetch Forecast&quot;
            weatherText.Text = weather
        End Sub

        Private Sub HideClockFaceStoryboard_Completed(ByVal sender As Object, ByVal args As EventArgs)
            showWeatherImageStoryboard.Begin(Me)
        End Sub

        Private Sub HideWeatherImageStoryboard_Completed(ByVal sender As Object, ByVal args As EventArgs)
            showClockFaceStoryboard.Begin(Me, True)
        End Sub
    End Class
End Namespace
">
Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Media
Imports System.Windows.Media.Animation
Imports System.Windows.Media.Imaging
Imports System.Windows.Shapes
Imports System.Windows.Threading
Imports System.Threading

Namespace SDKSamples
    Partial Public Class Window1
        Inherits Window
        ' Delegates to be used in placking jobs onto the Dispatcher.
        Private Delegate Sub NoArgDelegate()
        Private Delegate Sub OneArgDelegate(ByVal arg As String)

        ' Storyboards for the animations.
        Private showClockFaceStoryboard As Storyboard
        Private hideClockFaceStoryboard As Storyboard
        Private showWeatherImageStoryboard As Storyboard
        Private hideWeatherImageStoryboard As Storyboard

        Public Sub New()
            MyBase.New()
            InitializeComponent()
        End Sub

        Private Sub Window_Loaded(ByVal sender As Object, ByVal e As RoutedEventArgs)
            ' Load the storyboard resources.
            showClockFaceStoryboard = CType(Me.Resources("ShowClockFaceStoryboard"), Storyboard)
            hideClockFaceStoryboard = CType(Me.Resources("HideClockFaceStoryboard"), Storyboard)
            showWeatherImageStoryboard = CType(Me.Resources("ShowWeatherImageStoryboard"), Storyboard)
            hideWeatherImageStoryboard = CType(Me.Resources("HideWeatherImageStoryboard"), Storyboard)
        End Sub

        Private Sub ForecastButtonHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)
            ' Change the status image and start the rotation animation.
            fetchButton.IsEnabled = False
            fetchButton.Content = "Contacting Server"
            weatherText.Text = ""
            hideWeatherImageStoryboard.Begin(Me)

            ' Start fetching the weather forecast asynchronously.
            Dim fetcher As New NoArgDelegate(AddressOf Me.FetchWeatherFromServer)

            fetcher.BeginInvoke(Nothing, Nothing)
        End Sub

        Private Sub FetchWeatherFromServer()
            ' Simulate the delay from network access.
            Thread.Sleep(4000)

            ' Tried and true method for weather forecasting - random numbers.
            Dim rand As New Random()
            Dim weather As String

            If rand.Next(2) = 0 Then
                weather = "rainy"
            Else
                weather = "sunny"
            End If

            ' Schedule the update function in the UI thread.
            tomorrowsWeather.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.Normal, New OneArgDelegate(AddressOf UpdateUserInterface), weather)
        End Sub

        Private Sub UpdateUserInterface(ByVal weather As String)
            'Set the weather image
            If weather = "sunny" Then
                weatherIndicatorImage.Source = CType(Me.Resources("SunnyImageSource"), ImageSource)
            ElseIf weather = "rainy" Then
                weatherIndicatorImage.Source = CType(Me.Resources("RainingImageSource"), ImageSource)
            End If

            'Stop clock animation
            showClockFaceStoryboard.Stop(Me)
            hideClockFaceStoryboard.Begin(Me)

            'Update UI text
            fetchButton.IsEnabled = True
            fetchButton.Content = "Fetch Forecast"
            weatherText.Text = weather
        End Sub

        Private Sub HideClockFaceStoryboard_Completed(ByVal sender As Object, ByVal args As EventArgs)
            showWeatherImageStoryboard.Begin(Me)
        End Sub

        Private Sub HideWeatherImageStoryboard_Completed(ByVal sender As Object, ByVal args As EventArgs)
            showClockFaceStoryboard.Begin(Me, True)
        End Sub
    End Class
End Namespace
</code></pre>
<p>The following are some of the details to be noted.</p>
<ul>
<li><p>Creating the Button Handler</p>
<div class="codeHeader" id="code-try-5" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingWeatherForecast#ThreadingWeatherButtonHandler" data-author-content="private void ForecastButtonHandler(object sender, RoutedEventArgs e)
{
    // Change the status image and start the rotation animation.
    fetchButton.IsEnabled = false;
    fetchButton.Content = &quot;Contacting Server&quot;;
    weatherText.Text = &quot;&quot;;
    hideWeatherImageStoryboard.Begin(this);

    // Start fetching the weather forecast asynchronously.
    NoArgDelegate fetcher = new NoArgDelegate(
        this.FetchWeatherFromServer);

    fetcher.BeginInvoke(null, null);
}
"><span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ForecastButtonHandler</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, RoutedEventArgs e</span>)</span>
{
    <span class="hljs-comment">// Change the status image and start the rotation animation.</span>
    fetchButton.IsEnabled = <span class="hljs-literal">false</span>;
    fetchButton.Content = <span class="hljs-string">"Contacting Server"</span>;
    weatherText.Text = <span class="hljs-string">""</span>;
    hideWeatherImageStoryboard.Begin(<span class="hljs-keyword">this</span>);

    <span class="hljs-comment">// Start fetching the weather forecast asynchronously.</span>
    NoArgDelegate fetcher = <span class="hljs-keyword">new</span> NoArgDelegate(
        <span class="hljs-keyword">this</span>.FetchWeatherFromServer);

    fetcher.BeginInvoke(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingWeatherForecast#ThreadingWeatherButtonHandler" data-author-content="Private Sub ForecastButtonHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)
    &#39; Change the status image and start the rotation animation.
    fetchButton.IsEnabled = False
    fetchButton.Content = &quot;Contacting Server&quot;
    weatherText.Text = &quot;&quot;
    hideWeatherImageStoryboard.Begin(Me)

    &#39; Start fetching the weather forecast asynchronously.
    Dim fetcher As New NoArgDelegate(AddressOf Me.FetchWeatherFromServer)

    fetcher.BeginInvoke(Nothing, Nothing)
End Sub
">Private Sub ForecastButtonHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)
    ' Change the status image and start the rotation animation.
    fetchButton.IsEnabled = False
    fetchButton.Content = "Contacting Server"
    weatherText.Text = ""
    hideWeatherImageStoryboard.Begin(Me)

    ' Start fetching the weather forecast asynchronously.
    Dim fetcher As New NoArgDelegate(AddressOf Me.FetchWeatherFromServer)

    fetcher.BeginInvoke(Nothing, Nothing)
End Sub
</code></pre></li>
</ul>
<p>When the button is clicked, we display the clock drawing and start animating it. We disable the button. We invoke the <code>FetchWeatherFromServer</code> method in a new thread, and then we return, allowing the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> to process events while we wait to collect the weather forecast.</p>
<ul>
<li><p>Fetching the Weather</p>
<div class="codeHeader" id="code-try-6" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingWeatherForecast#ThreadingWeatherFetchWeather" data-author-content="private void FetchWeatherFromServer()
{
    // Simulate the delay from network access.
    Thread.Sleep(4000);

    // Tried and true method for weather forecasting - random numbers.
    Random rand = new Random();
    String weather;

    if (rand.Next(2) == 0)
    {
        weather = &quot;rainy&quot;;
    }
    else
    {
        weather = &quot;sunny&quot;;
    }

    // Schedule the update function in the UI thread.
    tomorrowsWeather.Dispatcher.BeginInvoke(
        System.Windows.Threading.DispatcherPriority.Normal,
        new OneArgDelegate(UpdateUserInterface),
        weather);
}
"><span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FetchWeatherFromServer</span>(<span class="hljs-params"></span>)</span>
{
    <span class="hljs-comment">// Simulate the delay from network access.</span>
    Thread.Sleep(<span class="hljs-number">4000</span>);

    <span class="hljs-comment">// Tried and true method for weather forecasting - random numbers.</span>
    Random rand = <span class="hljs-keyword">new</span> Random();
    String weather;

    <span class="hljs-keyword">if</span> (rand.Next(<span class="hljs-number">2</span>) == <span class="hljs-number">0</span>)
    {
        weather = <span class="hljs-string">"rainy"</span>;
    }
    <span class="hljs-keyword">else</span>
    {
        weather = <span class="hljs-string">"sunny"</span>;
    }

    <span class="hljs-comment">// Schedule the update function in the UI thread.</span>
    tomorrowsWeather.Dispatcher.BeginInvoke(
        System.Windows.Threading.DispatcherPriority.Normal,
        <span class="hljs-keyword">new</span> OneArgDelegate(UpdateUserInterface),
        weather);
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingWeatherForecast#ThreadingWeatherFetchWeather" data-author-content="Private Sub FetchWeatherFromServer()
    &#39; Simulate the delay from network access.
    Thread.Sleep(4000)

    &#39; Tried and true method for weather forecasting - random numbers.
    Dim rand As New Random()
    Dim weather As String

    If rand.Next(2) = 0 Then
        weather = &quot;rainy&quot;
    Else
        weather = &quot;sunny&quot;
    End If

    &#39; Schedule the update function in the UI thread.
    tomorrowsWeather.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.Normal, New OneArgDelegate(AddressOf UpdateUserInterface), weather)
End Sub
">Private Sub FetchWeatherFromServer()
    ' Simulate the delay from network access.
    Thread.Sleep(4000)

    ' Tried and true method for weather forecasting - random numbers.
    Dim rand As New Random()
    Dim weather As String

    If rand.Next(2) = 0 Then
        weather = "rainy"
    Else
        weather = "sunny"
    End If

    ' Schedule the update function in the UI thread.
    tomorrowsWeather.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.Normal, New OneArgDelegate(AddressOf UpdateUserInterface), weather)
End Sub
</code></pre></li>
</ul>
<p>To keep things simple, we don’t actually have any networking code in this example. Instead, we simulate the delay of network access by putting our new thread to sleep for four seconds. In this time, the original UI thread is still running and responding to events. To show this, we’ve left an animation running, and the minimize and maximize buttons also continue to work.</p>
<p>When the delay is finished, and we’ve randomly selected our weather forecast, it’s time to report back to the UI thread. We do this by scheduling a call to <code>UpdateUserInterface</code> in the UI thread using that thread’s <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a>. We pass a string describing the weather to this scheduled method call.</p>
<ul>
<li><p>Updating the UI</p>
<div class="codeHeader" id="code-try-7" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingWeatherForecast#ThreadingWeatherUpdateUI" data-author-content="private void UpdateUserInterface(String weather)
{
    //Set the weather image
    if (weather == &quot;sunny&quot;)
    {
        weatherIndicatorImage.Source = (ImageSource)this.Resources[
            &quot;SunnyImageSource&quot;];
    }
    else if (weather == &quot;rainy&quot;)
    {
        weatherIndicatorImage.Source = (ImageSource)this.Resources[
            &quot;RainingImageSource&quot;];
    }

    //Stop clock animation
    showClockFaceStoryboard.Stop(this);
    hideClockFaceStoryboard.Begin(this);

    //Update UI text
    fetchButton.IsEnabled = true;
    fetchButton.Content = &quot;Fetch Forecast&quot;;
    weatherText.Text = weather;
}
"><span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateUserInterface</span>(<span class="hljs-params">String weather</span>)</span>
{
    <span class="hljs-comment">//Set the weather image</span>
    <span class="hljs-keyword">if</span> (weather == <span class="hljs-string">"sunny"</span>)
    {
        weatherIndicatorImage.Source = (ImageSource)<span class="hljs-keyword">this</span>.Resources[
            <span class="hljs-string">"SunnyImageSource"</span>];
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (weather == <span class="hljs-string">"rainy"</span>)
    {
        weatherIndicatorImage.Source = (ImageSource)<span class="hljs-keyword">this</span>.Resources[
            <span class="hljs-string">"RainingImageSource"</span>];
    }

    <span class="hljs-comment">//Stop clock animation</span>
    showClockFaceStoryboard.Stop(<span class="hljs-keyword">this</span>);
    hideClockFaceStoryboard.Begin(<span class="hljs-keyword">this</span>);

    <span class="hljs-comment">//Update UI text</span>
    fetchButton.IsEnabled = <span class="hljs-literal">true</span>;
    fetchButton.Content = <span class="hljs-string">"Fetch Forecast"</span>;
    weatherText.Text = weather;
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingWeatherForecast#ThreadingWeatherUpdateUI" data-author-content="Private Sub UpdateUserInterface(ByVal weather As String)
    &#39;Set the weather image
    If weather = &quot;sunny&quot; Then
        weatherIndicatorImage.Source = CType(Me.Resources(&quot;SunnyImageSource&quot;), ImageSource)
    ElseIf weather = &quot;rainy&quot; Then
        weatherIndicatorImage.Source = CType(Me.Resources(&quot;RainingImageSource&quot;), ImageSource)
    End If

    &#39;Stop clock animation
    showClockFaceStoryboard.Stop(Me)
    hideClockFaceStoryboard.Begin(Me)

    &#39;Update UI text
    fetchButton.IsEnabled = True
    fetchButton.Content = &quot;Fetch Forecast&quot;
    weatherText.Text = weather
End Sub
">Private Sub UpdateUserInterface(ByVal weather As String)
    'Set the weather image
    If weather = "sunny" Then
        weatherIndicatorImage.Source = CType(Me.Resources("SunnyImageSource"), ImageSource)
    ElseIf weather = "rainy" Then
        weatherIndicatorImage.Source = CType(Me.Resources("RainingImageSource"), ImageSource)
    End If

    'Stop clock animation
    showClockFaceStoryboard.Stop(Me)
    hideClockFaceStoryboard.Begin(Me)

    'Update UI text
    fetchButton.IsEnabled = True
    fetchButton.Content = "Fetch Forecast"
    weatherText.Text = weather
End Sub
</code></pre></li>
</ul>
<p>When the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> in the UI thread has time, it executes the scheduled call to <code>UpdateUserInterface</code>. This method stops the clock animation and chooses an image to describe the weather. It displays this image and restores the "fetch forecast" button.</p>
<p><a name="multi_browser"></a></p>
<h3 id="multiple-windows-multiple-threads" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#multiple-windows-multiple-threads" aria-labelledby="multiple-windows-multiple-threads"></a>Multiple Windows, Multiple Threads</h3>
<p>Some WPF applications require multiple top-level windows. It is perfectly acceptable for one Thread/<a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> combination to manage multiple windows, but sometimes several threads do a better job. This is especially true if there is any chance that one of the windows will monopolize the thread.</p>
<p>Windows Explorer works in this fashion. Each new Explorer window belongs to the original process, but it is created under the control of an independent thread.</p>
<p>By using a WPF<a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.frame" data-linktype="absolute-path">Frame</a> control, we can display Web pages. We can easily create a simple Internet Explorer substitute. We start with an important feature: the ability to open a new explorer window. When the user clicks the "new window" button, we launch a copy of our window in a separate thread. This way, long-running or blocking operations in one of the windows won’t lock all the other windows.</p>
<p>In reality, the Web browser model has its own complicated threading model. We’ve chosen it because it should be familiar to most readers.</p>
<p>The following example shows the code.</p>
<div class="codeHeader" id="code-try-8" data-bi-name="code-header"><span class="language">XAML</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-xaml" name="ThreadingMultipleBrowsers#ThreadingMultiBrowserXAML" data-author-content="&lt;Window x:Class=&quot;SDKSamples.Window1&quot;
    xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
    xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
    Title=&quot;MultiBrowse&quot;
    Height=&quot;600&quot; 
    Width=&quot;800&quot;
    Loaded=&quot;OnLoaded&quot;
    &gt;
  &lt;StackPanel Name=&quot;Stack&quot; Orientation=&quot;Vertical&quot;&gt;
    &lt;StackPanel Orientation=&quot;Horizontal&quot;&gt;
      &lt;Button Content=&quot;New Window&quot;
              Click=&quot;NewWindowHandler&quot; /&gt;
      &lt;TextBox Name=&quot;newLocation&quot;
               Width=&quot;500&quot; /&gt;
      &lt;Button Content=&quot;GO!&quot;
              Click=&quot;Browse&quot; /&gt;
    &lt;/StackPanel&gt;

    &lt;Frame Name=&quot;placeHolder&quot;
            Width=&quot;800&quot;
            Height=&quot;550&quot;&gt;&lt;/Frame&gt;
  &lt;/StackPanel&gt;
&lt;/Window&gt;
"><span><span class="hljs-tag">&lt;<span class="hljs-name">Window</span> <span class="hljs-attr">x:Class</span>=<span class="hljs-string">"SDKSamples.Window1"</span>
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
    <span class="hljs-attr">xmlns:x</span>=<span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
    <span class="hljs-attr">Title</span>=<span class="hljs-string">"MultiBrowse"</span>
    <span class="hljs-attr">Height</span>=<span class="hljs-string">"600"</span> 
    <span class="hljs-attr">Width</span>=<span class="hljs-string">"800"</span>
    <span class="hljs-attr">Loaded</span>=<span class="hljs-string">"OnLoaded"</span>
    &gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">StackPanel</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">"Stack"</span> <span class="hljs-attr">Orientation</span>=<span class="hljs-string">"Vertical"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">StackPanel</span> <span class="hljs-attr">Orientation</span>=<span class="hljs-string">"Horizontal"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">Content</span>=<span class="hljs-string">"New Window"</span>
              <span class="hljs-attr">Click</span>=<span class="hljs-string">"NewWindowHandler"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TextBox</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">"newLocation"</span>
               <span class="hljs-attr">Width</span>=<span class="hljs-string">"500"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">Content</span>=<span class="hljs-string">"GO!"</span>
              <span class="hljs-attr">Click</span>=<span class="hljs-string">"Browse"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">StackPanel</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">Frame</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">"placeHolder"</span>
            <span class="hljs-attr">Width</span>=<span class="hljs-string">"800"</span>
            <span class="hljs-attr">Height</span>=<span class="hljs-string">"550"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Frame</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">StackPanel</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Window</span>&gt;</span>
</span></code></pre><div class="codeHeader" id="code-try-9" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingMultipleBrowsers#ThreadingMultiBrowserCodeBehind" data-author-content="using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Threading;
using System.Threading;

namespace SDKSamples
{
    public partial class Window1 : Window
    {

        public Window1() : base()
        {
            InitializeComponent();
        }

        private void OnLoaded(object sender, RoutedEventArgs e)
        {
           placeHolder.Source = new Uri(&quot;http://www.msn.com&quot;);
        }

        private void Browse(object sender, RoutedEventArgs e)
        {
            placeHolder.Source = new Uri(newLocation.Text);
        }

        private void NewWindowHandler(object sender, RoutedEventArgs e)
        {
            Thread newWindowThread = new Thread(new ThreadStart(ThreadStartingPoint));
            newWindowThread.SetApartmentState(ApartmentState.STA);
            newWindowThread.IsBackground = true;
            newWindowThread.Start();
        }

        private void ThreadStartingPoint()
        {
            Window1 tempWindow = new Window1();
            tempWindow.Show();
            System.Windows.Threading.Dispatcher.Run();
        }
    }
}
"><span><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Windows;
<span class="hljs-keyword">using</span> System.Windows.Controls;
<span class="hljs-keyword">using</span> System.Windows.Data;
<span class="hljs-keyword">using</span> System.Windows.Threading;
<span class="hljs-keyword">using</span> System.Threading;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">SDKSamples</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Window1</span> : <span class="hljs-title">Window</span>
    {

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Window1</span>(<span class="hljs-params"></span>) : <span class="hljs-title">base</span>(<span class="hljs-params"></span>)</span>
        {
            InitializeComponent();
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnLoaded</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, RoutedEventArgs e</span>)</span>
        {
           placeHolder.Source = <span class="hljs-keyword">new</span> Uri(<span class="hljs-string">"http://www.msn.com"</span>);
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Browse</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, RoutedEventArgs e</span>)</span>
        {
            placeHolder.Source = <span class="hljs-keyword">new</span> Uri(newLocation.Text);
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">NewWindowHandler</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, RoutedEventArgs e</span>)</span>
        {
            Thread newWindowThread = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> ThreadStart(ThreadStartingPoint));
            newWindowThread.SetApartmentState(ApartmentState.STA);
            newWindowThread.IsBackground = <span class="hljs-literal">true</span>;
            newWindowThread.Start();
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadStartingPoint</span>(<span class="hljs-params"></span>)</span>
        {
            Window1 tempWindow = <span class="hljs-keyword">new</span> Window1();
            tempWindow.Show();
            System.Windows.Threading.Dispatcher.Run();
        }
    }
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingMultipleBrowsers#ThreadingMultiBrowserCodeBehind" data-author-content="
Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Data
Imports System.Windows.Threading
Imports System.Threading


Namespace SDKSamples
    Partial Public Class Window1
        Inherits Window

        Public Sub New()
            MyBase.New()
            InitializeComponent()
        End Sub

        Private Sub OnLoaded(ByVal sender As Object, ByVal e As RoutedEventArgs)
           placeHolder.Source = New Uri(&quot;http://www.msn.com&quot;)
        End Sub

        Private Sub Browse(ByVal sender As Object, ByVal e As RoutedEventArgs)
            placeHolder.Source = New Uri(newLocation.Text)
        End Sub

        Private Sub NewWindowHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)
            Dim newWindowThread As New Thread(New ThreadStart(AddressOf ThreadStartingPoint))
            newWindowThread.SetApartmentState(ApartmentState.STA)
            newWindowThread.IsBackground = True
            newWindowThread.Start()
        End Sub

        Private Sub ThreadStartingPoint()
            Dim tempWindow As New Window1()
            tempWindow.Show()
            System.Windows.Threading.Dispatcher.Run()
        End Sub
    End Class
End Namespace
">
Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Data
Imports System.Windows.Threading
Imports System.Threading


Namespace SDKSamples
    Partial Public Class Window1
        Inherits Window

        Public Sub New()
            MyBase.New()
            InitializeComponent()
        End Sub

        Private Sub OnLoaded(ByVal sender As Object, ByVal e As RoutedEventArgs)
           placeHolder.Source = New Uri("http://www.msn.com")
        End Sub

        Private Sub Browse(ByVal sender As Object, ByVal e As RoutedEventArgs)
            placeHolder.Source = New Uri(newLocation.Text)
        End Sub

        Private Sub NewWindowHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)
            Dim newWindowThread As New Thread(New ThreadStart(AddressOf ThreadStartingPoint))
            newWindowThread.SetApartmentState(ApartmentState.STA)
            newWindowThread.IsBackground = True
            newWindowThread.Start()
        End Sub

        Private Sub ThreadStartingPoint()
            Dim tempWindow As New Window1()
            tempWindow.Show()
            System.Windows.Threading.Dispatcher.Run()
        End Sub
    End Class
End Namespace
</code></pre>
<p>The following threading segments of this code are the most interesting to us in this context:</p>
<div class="codeHeader" id="code-try-10" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingMultipleBrowsers#ThreadingMultiBrowserNewWindow" data-author-content="private void NewWindowHandler(object sender, RoutedEventArgs e)
{
    Thread newWindowThread = new Thread(new ThreadStart(ThreadStartingPoint));
    newWindowThread.SetApartmentState(ApartmentState.STA);
    newWindowThread.IsBackground = true;
    newWindowThread.Start();
}
"><span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">NewWindowHandler</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, RoutedEventArgs e</span>)</span>
{
    Thread newWindowThread = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> ThreadStart(ThreadStartingPoint));
    newWindowThread.SetApartmentState(ApartmentState.STA);
    newWindowThread.IsBackground = <span class="hljs-literal">true</span>;
    newWindowThread.Start();
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingMultipleBrowsers#ThreadingMultiBrowserNewWindow" data-author-content="Private Sub NewWindowHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)
    Dim newWindowThread As New Thread(New ThreadStart(AddressOf ThreadStartingPoint))
    newWindowThread.SetApartmentState(ApartmentState.STA)
    newWindowThread.IsBackground = True
    newWindowThread.Start()
End Sub
">Private Sub NewWindowHandler(ByVal sender As Object, ByVal e As RoutedEventArgs)
    Dim newWindowThread As New Thread(New ThreadStart(AddressOf ThreadStartingPoint))
    newWindowThread.SetApartmentState(ApartmentState.STA)
    newWindowThread.IsBackground = True
    newWindowThread.Start()
End Sub
</code></pre>
<p>This method is called when the "new window" button is clicked. It creates a new thread and starts it asynchronously.</p>
<div class="codeHeader" id="code-try-11" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="ThreadingMultipleBrowsers#ThreadingMultiBrowserThreadStart" data-author-content="private void ThreadStartingPoint()
{
    Window1 tempWindow = new Window1();
    tempWindow.Show();
    System.Windows.Threading.Dispatcher.Run();
}
"><span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadStartingPoint</span>(<span class="hljs-params"></span>)</span>
{
    Window1 tempWindow = <span class="hljs-keyword">new</span> Window1();
    tempWindow.Show();
    System.Windows.Threading.Dispatcher.Run();
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="ThreadingMultipleBrowsers#ThreadingMultiBrowserThreadStart" data-author-content="Private Sub ThreadStartingPoint()
    Dim tempWindow As New Window1()
    tempWindow.Show()
    System.Windows.Threading.Dispatcher.Run()
End Sub
">Private Sub ThreadStartingPoint()
    Dim tempWindow As New Window1()
    tempWindow.Show()
    System.Windows.Threading.Dispatcher.Run()
End Sub
</code></pre>
<p>This method is the starting point for the new thread. We create a new window under the control of this thread. WPF automatically creates a new <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> to manage the new thread. All we have to do to make the window functional is to start the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a>.</p>
<p><a name="stumbling_points"></a></p>
<h2 id="technical-details-and-stumbling-points" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#technical-details-and-stumbling-points" aria-labelledby="technical-details-and-stumbling-points"></a>Technical Details and Stumbling Points</h2>
<h3 id="writing-components-using-threading" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#writing-components-using-threading" aria-labelledby="writing-components-using-threading"></a>Writing Components Using Threading</h3>
<p>The Microsoft .NET Framework Developer's Guide describes a pattern for how a component can expose asynchronous behavior to its clients (see <a href="https://docs.microsoft.com/en-us/dotnet/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview" data-linktype="absolute-path">Event-based Asynchronous Pattern Overview</a>). For instance, suppose we wanted to package the <code>FetchWeatherFromServer</code> method into a reusable, nongraphical component. Following the standard Microsoft .NET Framework pattern, this would look something like the following.</p>
<div class="codeHeader" id="code-try-12" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="CommandingOverviewSnippets#ThreadingArticleWeatherComponent1" data-author-content="public class WeatherComponent : Component
{
    //gets weather: Synchronous
    public string GetWeather()
    {
        string weather = &quot;&quot;;

        //predict the weather

        return weather;
    }

    //get weather: Asynchronous
    public void GetWeatherAsync()
    {
        //get the weather
    }

    public event GetWeatherCompletedEventHandler GetWeatherCompleted;
}

public class GetWeatherCompletedEventArgs : AsyncCompletedEventArgs
{
    public GetWeatherCompletedEventArgs(Exception error, bool canceled,
        object userState, string weather)
        :
        base(error, canceled, userState)
    {
        _weather = weather;
    }

    public string Weather
    {
        get { return _weather; }
    }
    private string _weather;
}

public delegate void GetWeatherCompletedEventHandler(object sender,
    GetWeatherCompletedEventArgs e);
"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherComponent</span> : <span class="hljs-title">Component</span>
{
    <span class="hljs-comment">//gets weather: Synchronous</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-title">GetWeather</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">string</span> weather = <span class="hljs-string">""</span>;

        <span class="hljs-comment">//predict the weather</span>

        <span class="hljs-keyword">return</span> weather;
    }

    <span class="hljs-comment">//get weather: Asynchronous</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GetWeatherAsync</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-comment">//get the weather</span>
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> GetWeatherCompletedEventHandler GetWeatherCompleted;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GetWeatherCompletedEventArgs</span> : <span class="hljs-title">AsyncCompletedEventArgs</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GetWeatherCompletedEventArgs</span>(<span class="hljs-params">Exception error, <span class="hljs-keyword">bool</span> canceled,
        <span class="hljs-keyword">object</span> userState, <span class="hljs-keyword">string</span> weather</span>)
        :
        <span class="hljs-title">base</span>(<span class="hljs-params">error, canceled, userState</span>)</span>
    {
        _weather = weather;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Weather
    {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _weather; }
    }
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> _weather;
}

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GetWeatherCompletedEventHandler</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender,
    GetWeatherCompletedEventArgs e</span>)</span>;
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="CommandingOverviewSnippets#ThreadingArticleWeatherComponent1" data-author-content="Public Class WeatherComponent
    Inherits Component
    &#39;gets weather: Synchronous 
    Public Function GetWeather() As String
        Dim weather As String = &quot;&quot;

        &#39;predict the weather

        Return weather
    End Function

    &#39;get weather: Asynchronous 
    Public Sub GetWeatherAsync()
        &#39;get the weather
    End Sub

    Public Event GetWeatherCompleted As GetWeatherCompletedEventHandler
End Class

Public Class GetWeatherCompletedEventArgs
    Inherits AsyncCompletedEventArgs
    Public Sub New(ByVal [error] As Exception, ByVal canceled As Boolean, ByVal userState As Object, ByVal weather As String)
        MyBase.New([error], canceled, userState)
        _weather = weather
    End Sub

    Public ReadOnly Property Weather() As String
        Get
            Return _weather
        End Get
    End Property
    Private _weather As String
End Class

Public Delegate Sub GetWeatherCompletedEventHandler(ByVal sender As Object, ByVal e As GetWeatherCompletedEventArgs)
">Public Class WeatherComponent
    Inherits Component
    'gets weather: Synchronous 
    Public Function GetWeather() As String
        Dim weather As String = ""

        'predict the weather

        Return weather
    End Function

    'get weather: Asynchronous 
    Public Sub GetWeatherAsync()
        'get the weather
    End Sub

    Public Event GetWeatherCompleted As GetWeatherCompletedEventHandler
End Class

Public Class GetWeatherCompletedEventArgs
    Inherits AsyncCompletedEventArgs
    Public Sub New(ByVal [error] As Exception, ByVal canceled As Boolean, ByVal userState As Object, ByVal weather As String)
        MyBase.New([error], canceled, userState)
        _weather = weather
    End Sub

    Public ReadOnly Property Weather() As String
        Get
            Return _weather
        End Get
    End Property
    Private _weather As String
End Class

Public Delegate Sub GetWeatherCompletedEventHandler(ByVal sender As Object, ByVal e As GetWeatherCompletedEventArgs)
</code></pre>
<p><code>GetWeatherAsync</code> would use one of the techniques described earlier, such as creating a background thread, to do the work asynchronously, not blocking the calling thread.</p>
<p>One of the most important parts of this pattern is calling the <em>MethodName</em><code>Completed</code> method on the same thread that called the <em>MethodName</em><code>Async</code> method to begin with. You could do this using WPF fairly easily, by storing <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.currentdispatcher" data-linktype="absolute-path">CurrentDispatcher</a>—but then the nongraphical component could only be used in WPF applications, not in Windows Forms or ASP.NET programs.</p>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatchersynchronizationcontext" data-linktype="absolute-path">DispatcherSynchronizationContext</a> class addresses this need—think of it as a simplified version of <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> that works with other UI frameworks as well.</p>
<div class="codeHeader" id="code-try-13" data-bi-name="code-header"><span class="language">C#</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-csharp" name="CommandingOverviewSnippets#ThreadingArticleWeatherComponent2" data-author-content="public class WeatherComponent2 : Component
{
    public string GetWeather()
    {
        return fetchWeatherFromServer();
    }

    private DispatcherSynchronizationContext requestingContext = null;

    public void GetWeatherAsync()
    {
        if (requestingContext != null)
            throw new InvalidOperationException(&quot;This component can only handle 1 async request at a time&quot;);

        requestingContext = (DispatcherSynchronizationContext)DispatcherSynchronizationContext.Current;

        NoArgDelegate fetcher = new NoArgDelegate(this.fetchWeatherFromServer);

        // Launch thread
        fetcher.BeginInvoke(null, null);
    }

    private void RaiseEvent(GetWeatherCompletedEventArgs e)
    {
        if (GetWeatherCompleted != null)
            GetWeatherCompleted(this, e);
    }

    private string fetchWeatherFromServer()
    {
        // do stuff
        string weather = &quot;&quot;;

        GetWeatherCompletedEventArgs e =
            new GetWeatherCompletedEventArgs(null, false, null, weather);

        SendOrPostCallback callback = new SendOrPostCallback(DoEvent);
        requestingContext.Post(callback, e);
        requestingContext = null;

        return e.Weather;
    }

    private void DoEvent(object e)
    {
        //do stuff
    }

    public event GetWeatherCompletedEventHandler GetWeatherCompleted;
    public delegate string NoArgDelegate();
}
"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherComponent2</span> : <span class="hljs-title">Component</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-title">GetWeather</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">return</span> fetchWeatherFromServer();
    }

    <span class="hljs-keyword">private</span> DispatcherSynchronizationContext requestingContext = <span class="hljs-literal">null</span>;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GetWeatherAsync</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">if</span> (requestingContext != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidOperationException(<span class="hljs-string">"This component can only handle 1 async request at a time"</span>);

        requestingContext = (DispatcherSynchronizationContext)DispatcherSynchronizationContext.Current;

        NoArgDelegate fetcher = <span class="hljs-keyword">new</span> NoArgDelegate(<span class="hljs-keyword">this</span>.fetchWeatherFromServer);

        <span class="hljs-comment">// Launch thread</span>
        fetcher.BeginInvoke(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RaiseEvent</span>(<span class="hljs-params">GetWeatherCompletedEventArgs e</span>)</span>
    {
        <span class="hljs-keyword">if</span> (GetWeatherCompleted != <span class="hljs-literal">null</span>)
            GetWeatherCompleted(<span class="hljs-keyword">this</span>, e);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> <span class="hljs-title">fetchWeatherFromServer</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-comment">// do stuff</span>
        <span class="hljs-keyword">string</span> weather = <span class="hljs-string">""</span>;

        GetWeatherCompletedEventArgs e =
            <span class="hljs-keyword">new</span> GetWeatherCompletedEventArgs(<span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>, weather);

        SendOrPostCallback callback = <span class="hljs-keyword">new</span> SendOrPostCallback(DoEvent);
        requestingContext.Post(callback, e);
        requestingContext = <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">return</span> e.Weather;
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoEvent</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> e</span>)</span>
    {
        <span class="hljs-comment">//do stuff</span>
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> GetWeatherCompletedEventHandler GetWeatherCompleted;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">delegate</span> <span class="hljs-keyword">string</span> <span class="hljs-title">NoArgDelegate</span>(<span class="hljs-params"></span>)</span>;
}
</span></code></pre><pre tabindex="0" class="has-inner-focus" hidden=""><code class="lang-vb" name="CommandingOverviewSnippets#ThreadingArticleWeatherComponent2" data-author-content="Public Class WeatherComponent2
    Inherits Component
    Public Function GetWeather() As String
        Return fetchWeatherFromServer()
    End Function

    Private requestingContext As DispatcherSynchronizationContext = Nothing

    Public Sub GetWeatherAsync()
        If requestingContext IsNot Nothing Then
            Throw New InvalidOperationException(&quot;This component can only handle 1 async request at a time&quot;)
        End If

        requestingContext = CType(DispatcherSynchronizationContext.Current, DispatcherSynchronizationContext)

        Dim fetcher As New NoArgDelegate(AddressOf Me.fetchWeatherFromServer)

        &#39; Launch thread
        fetcher.BeginInvoke(Nothing, Nothing)
    End Sub

    Private Sub [RaiseEvent](ByVal e As GetWeatherCompletedEventArgs)
        RaiseEvent GetWeatherCompleted(Me, e)
    End Sub

    Private Function fetchWeatherFromServer() As String
        &#39; do stuff
        Dim weather As String = &quot;&quot;

        Dim e As New GetWeatherCompletedEventArgs(Nothing, False, Nothing, weather)

        Dim callback As New SendOrPostCallback(AddressOf DoEvent)
        requestingContext.Post(callback, e)
        requestingContext = Nothing

        Return e.Weather
    End Function

    Private Sub DoEvent(ByVal e As Object)
        &#39;do stuff
    End Sub

    Public Event GetWeatherCompleted As GetWeatherCompletedEventHandler
    Public Delegate Function NoArgDelegate() As String
End Class
">Public Class WeatherComponent2
    Inherits Component
    Public Function GetWeather() As String
        Return fetchWeatherFromServer()
    End Function

    Private requestingContext As DispatcherSynchronizationContext = Nothing

    Public Sub GetWeatherAsync()
        If requestingContext IsNot Nothing Then
            Throw New InvalidOperationException("This component can only handle 1 async request at a time")
        End If

        requestingContext = CType(DispatcherSynchronizationContext.Current, DispatcherSynchronizationContext)

        Dim fetcher As New NoArgDelegate(AddressOf Me.fetchWeatherFromServer)

        ' Launch thread
        fetcher.BeginInvoke(Nothing, Nothing)
    End Sub

    Private Sub [RaiseEvent](ByVal e As GetWeatherCompletedEventArgs)
        RaiseEvent GetWeatherCompleted(Me, e)
    End Sub

    Private Function fetchWeatherFromServer() As String
        ' do stuff
        Dim weather As String = ""

        Dim e As New GetWeatherCompletedEventArgs(Nothing, False, Nothing, weather)

        Dim callback As New SendOrPostCallback(AddressOf DoEvent)
        requestingContext.Post(callback, e)
        requestingContext = Nothing

        Return e.Weather
    End Function

    Private Sub DoEvent(ByVal e As Object)
        'do stuff
    End Sub

    Public Event GetWeatherCompleted As GetWeatherCompletedEventHandler
    Public Delegate Function NoArgDelegate() As String
End Class
</code></pre><h3 id="nested-pumping" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#nested-pumping" aria-labelledby="nested-pumping"></a>Nested Pumping</h3>
<p>Sometimes it is not feasible to completely lock up the UI thread. Let’s consider the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.messagebox.show" data-linktype="absolute-path">Show</a> method of the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.messagebox" data-linktype="absolute-path">MessageBox</a> class. <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.messagebox.show" data-linktype="absolute-path">Show</a> doesn’t return until the user clicks the OK button. It does, however, create a window that must have a message loop in order to be interactive. While we are waiting for the user to click OK, the original application window does not respond to user input. It does, however, continue to process paint messages. The original window redraws itself when covered and revealed.</p>
<p><img src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/threading-message-loop.png" alt="Screenshot that shows a MessageBox with an OK button" data-linktype="relative-path"></p>
<p>Some thread must be in charge of the message box window. WPF could create a new thread just for the message box window, but this thread would be unable to paint the disabled elements in the original window (remember the earlier discussion of mutual exclusion). Instead, WPF uses a nested message processing system. The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher" data-linktype="absolute-path">Dispatcher</a> class includes a special method called <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.pushframe" data-linktype="absolute-path">PushFrame</a>, which stores an application’s current execution point then begins a new message loop. When the nested message loop finishes, execution resumes after the original <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.pushframe" data-linktype="absolute-path">PushFrame</a> call.</p>
<p>In this case, <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.pushframe" data-linktype="absolute-path">PushFrame</a> maintains the program context at the call to <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.messagebox.show" data-linktype="absolute-path">MessageBox.Show</a>, and it starts a new message loop to repaint the background window and handle input to the message box window. When the user clicks OK and clears the pop-up window, the nested loop exits and control resumes after the call to <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.messagebox.show" data-linktype="absolute-path">Show</a>.</p>
<h3 id="stale-routed-events" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#stale-routed-events" aria-labelledby="stale-routed-events"></a>Stale Routed Events</h3>
<p>The routed event system in WPF notifies entire trees when events are raised.</p>
<div class="codeHeader" id="code-try-14" data-bi-name="code-header"><span class="language">XAML</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-xaml" name="InputOvw#ThreadingArticleStaticRoutedEvent" data-author-content="&lt;Canvas MouseLeftButtonDown=&quot;handler1&quot; 
        Width=&quot;100&quot;
        Height=&quot;100&quot;
        &gt;
  &lt;Ellipse Width=&quot;50&quot;
           Height=&quot;50&quot;
           Fill=&quot;Blue&quot; 
           Canvas.Left=&quot;30&quot;
           Canvas.Top=&quot;50&quot; 
           MouseLeftButtonDown=&quot;handler2&quot;
           /&gt;
&lt;/Canvas&gt;
"><span><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">MouseLeftButtonDown</span>=<span class="hljs-string">"handler1"</span> 
        <span class="hljs-attr">Width</span>=<span class="hljs-string">"100"</span>
        <span class="hljs-attr">Height</span>=<span class="hljs-string">"100"</span>
        &gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Ellipse</span> <span class="hljs-attr">Width</span>=<span class="hljs-string">"50"</span>
           <span class="hljs-attr">Height</span>=<span class="hljs-string">"50"</span>
           <span class="hljs-attr">Fill</span>=<span class="hljs-string">"Blue"</span> 
           <span class="hljs-attr">Canvas.Left</span>=<span class="hljs-string">"30"</span>
           <span class="hljs-attr">Canvas.Top</span>=<span class="hljs-string">"50"</span> 
           <span class="hljs-attr">MouseLeftButtonDown</span>=<span class="hljs-string">"handler2"</span>
           /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span>
</span></code></pre>
<p>When the left mouse button is pressed over the ellipse, <code>handler2</code> is executed. After <code>handler2</code> finishes, the event is passed along to the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.canvas" data-linktype="absolute-path">Canvas</a> object, which uses <code>handler1</code> to process it. This happens only if <code>handler2</code> does not explicitly mark the event object as handled.</p>
<p>It’s possible that <code>handler2</code> will take a great deal of time processing this event. <code>handler2</code> might use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.pushframe" data-linktype="absolute-path">PushFrame</a> to begin a nested message loop that doesn’t return for hours. If <code>handler2</code> does not mark the event as handled when this message loop is complete, the event is passed up the tree even though it is very old.</p>
<h3 id="reentrancy-and-locking" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#reentrancy-and-locking" aria-labelledby="reentrancy-and-locking"></a>Reentrancy and Locking</h3>
<p>The locking mechanism of the common language runtime (CLR) doesn’t behave exactly as one might imagine; one might expect a thread to cease operation completely when requesting a lock. In actuality, the thread continues to receive and process high-priority messages. This helps prevent deadlocks and make interfaces minimally responsive, but it introduces the possibility for subtle bugs.  The vast majority of the time you don’t need to know anything about this, but under rare circumstances (usually involving Win32 window messages or COM STA components) this can be worth knowing.</p>
<p>Most interfaces are not built with thread safety in mind because developers work under the assumption that a UI is never accessed by more than one thread. In this case, that single thread may make environmental changes at unexpected times, causing those ill effects that the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcherobject" data-linktype="absolute-path">DispatcherObject</a> mutual exclusion mechanism is supposed to solve. Consider the following pseudocode:</p>
<p><img src="./Threading Model - WPF .NET Framework _ Microsoft Docs_files/threading-reentrancy.png" alt="Diagram that shows threading reentrancy." title="ThreadingReentrancy" data-linktype="relative-path"></p>
<p>Most of the time that’s the right thing, but there are times in WPF where such unexpected reentrancy can really cause problems. So, at certain key times, WPF calls <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.disableprocessing" data-linktype="absolute-path">DisableProcessing</a>, which changes the lock instruction for that thread to use the WPF reentrancy-free lock, instead of the usual CLR lock.</p>
<p>So why did the CLR team choose this behavior? It had to do with COM STA objects and the finalization thread. When an object is garbage collected, its <code>Finalize</code> method is run on the dedicated finalizer thread, not the UI thread. And therein lies the problem, because a COM STA object that was created on the UI thread can only be disposed on the UI thread. The CLR does the equivalent of a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.begininvoke" data-linktype="absolute-path">BeginInvoke</a> (in this case using Win32’s <code>SendMessage</code>). But if the UI thread is busy, the finalizer thread is stalled and the COM STA object can’t be disposed, which creates a serious memory leak. So the CLR team made the tough call to make locks work the way they do.</p>
<p>The task for WPF is to avoid unexpected reentrancy without reintroducing the memory leak, which is why we don’t block reentrancy everywhere.</p>
<h2 id="see-also" class="heading-anchor"><a class="anchor-link docon docon-link" href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#see-also" aria-labelledby="see-also"></a>See also</h2>
<ul>
<li><a href="https://github.com/Microsoft/WPF-Samples/tree/master/Threading/SingleThreadedApplication" data-linktype="external">Single-Threaded Application with Long-Running Calculation Sample</a></li>
</ul>

						<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop has-border-top has-margin-top-large has-padding-top-small">
									
									
<div class="feedback-verbatim has-border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
            <h3 class="has-text-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
            <div>
                <button class="thumb-rating like has-inner-focus has-padding-left-extra-small has-padding-right-extra-small" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus has-padding-none has-padding-right-extra-small" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box is-relative has-box-shadow-none has-border has-margin-top-small has-padding-extra-small is-size-extra-small">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required="" class="textarea has-border-none has-box-shadow-none has-inner-focus"></textarea>
            </div>
            <div class="buttons is-right has-margin-top-medium has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small has-border-none" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled="" type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								</div>
						<!-- end page rating section -->


						<!-- feedback section -->
<section class="feedback-section is-relative" data-bi-name="feedback-section">

    <h2 id="feedback" class="title is-3 has-margin-top-large">Feedback</h2>

    <div class="alert choose-feedback-type">
        <p aria-hidden="true" id="send-feedback-about">Submit and view feedback for</p>

        <div class="choose-feedback-buttons has-margin-top-medium">
                <a class="button feedback-type-product has-margin-bottom-small" aria-label="Send feedback about this product" href="https://developercommunity.visualstudio.com/spaces/61/index.html" data-bi-name="product-feedback">
                    <span>This product</span>
                    <span aria-hidden="true" class="icon docon docon-navigate-external is-size-h4 has-margin-left-none"></span>
                </a>

			<a class="button feedback-type-product has-margin-bottom-small github-link" aria-label="Send feedback about this page" data-bi-name="create-issue-on-github" href="https://github.com/dotnet/docs-desktop/issues/new?title=&amp;body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23%23%23%23%20Document%20Details%0A%0A%E2%9A%A0%20*Do%20not%20edit%20this%20section.%20It%20is%20required%20for%20docs.microsoft.com%20%E2%9E%9F%20GitHub%20issue%20linking.*%0A%0A*%20ID%3A%20b0bc9d86-b893-7c9f-d832-3c3026f5278e%0A*%20Version%20Independent%20ID%3A%205d75b64a-62d1-b0f9-b8fd-c84f60318808%0A*%20Content%3A%20%5BThreading%20Model%20-%20WPF%20.NET%20Framework%5D(https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fdotnet%2Fdesktop%2Fwpf%2Fadvanced%2Fthreading-model%3Fview%3Dnetframeworkdesktop-4.8)%0A*%20Content%20Source%3A%20%5Bdotnet-desktop-guide%2Fframework%2Fwpf%2Fadvanced%2Fthreading-model.md%5D(https%3A%2F%2Fgithub.com%2Fdotnet%2Fdocs-desktop%2Fblob%2Flive%2Fdotnet-desktop-guide%2Fframework%2Fwpf%2Fadvanced%2Fthreading-model.md)%0A*%20Product%3A%20**dotnet-framework**%0A*%20Technology%3A%20**dotnet-wpf**%0A*%20GitHub%20Login%3A%20%40adegeo%0A*%20Microsoft%20Alias%3A%20**adegeo**">
				<span aria-hidden="true" class="docon docon-brand-github has-padding-right-extra-small"></span>
				<span>This page</span>
			</a>
        </div>
    </div>

    <div class="action-container is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-small">
        <a class="view-on-github" data-bi-name="view-on-github" href="https://github.com/dotnet/docs-desktop/issues?utf8=%E2%9C%93&amp;q=%225d75b64a-62d1-b0f9-b8fd-c84f60318808%22&amp;in=body">
            <span aria-hidden="true" class="docon docon-brand-github"></span>
            <span>View all page feedback</span>
            <span aria-hidden="true" class="icon docon docon-navigate-external is-size-h5"></span>
        </a>
    </div>
</section>

						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="footerContainer is-visible-interactive has-default-focus ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">

    <div class="is-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link has-flex-shrink-none" href="https://docs.microsoft.com/en-us/locale?target=https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8" data-bi-name="select-locale"><span class="icon docon docon-world is-size-large has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text">English (United States)</span></a>
		<div class="has-margin-left-medium has-margin-right-medium has-flex-shrink-none">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="light" aria-pressed="false">
					<span class="theme-light has-margin-right-small">
						<span class="theme-selector-icon css-variable-support has-border is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start is-selected" data-theme-to="dark" aria-pressed="true">
					<span class="theme-dark has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
    <ul class="links" data-bi-name="footerlinks">
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
				<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://aka.ms/sitefeedback" data-bi-name="feedback">Site Feedback</a></li>
			<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>© Microsoft 2020</li>
    </ul>
</footer>
						</div>
					</div>

					<div class="is-size-small right-container column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only" data-bi-name="pageactions" role="complementary" aria-label="Page Actions">
						<div id="affixed-right-container" class="doc-outline is-fixed is-vertically-scrollable" style="width: 199.188px; top: 24px; bottom: 24px;">
								
								
<div class="feedback-verbatim has-border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
            <h3 class="has-text-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
            <div>
                <button class="thumb-rating like has-inner-focus has-padding-left-extra-small has-padding-right-extra-small" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus has-padding-none has-padding-right-extra-small" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box is-relative has-box-shadow-none has-border has-margin-top-small has-padding-extra-small is-size-extra-small">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required="" class="textarea has-border-none has-box-shadow-none has-inner-focus"></textarea>
            </div>
            <div class="buttons is-right has-margin-top-medium has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small has-border-none" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled="" type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>							<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
								<h3>In this article</h3>
							<ol><li class=""><a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#overview-and-the-dispatcher">Overview and the Dispatcher</a></li><li class="selected"><a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#threads-in-action-the-samples">Threads in Action: The Samples</a></li><li><a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#technical-details-and-stumbling-points">Technical Details and Stumbling Points</a></li><li><a href="https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8#see-also">See also</a></li></ol></nav>
						</div>
					</div>

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
		</div>

		<!--end of .mainContainer -->
	</div>

	<div id="openFeedbackContainer" class="openfeedback-container"></div>

	<div class="footerContainer has-default-focus is-hidden-interactive ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">

    <div class="is-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link has-flex-shrink-none" href="https://docs.microsoft.com/en-us/locale?target=https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/threading-model?view=netframeworkdesktop-4.8" data-bi-name="select-locale"><span class="icon docon docon-world is-size-large has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text">English (United States)</span></a>
		<div class="has-margin-left-medium has-margin-right-medium has-flex-shrink-none">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="light" aria-pressed="false">
					<span class="theme-light has-margin-right-small">
						<span class="theme-selector-icon css-variable-support has-border is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start is-selected" data-theme-to="dark" aria-pressed="true">
					<span class="theme-dark has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"></rect>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"></rect>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"></rect>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"></rect>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"></rect>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"></rect>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"></rect>
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
    <ul class="links" data-bi-name="footerlinks">
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
				<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://aka.ms/sitefeedback" data-bi-name="feedback">Site Feedback</a></li>
			<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>© Microsoft 2020</li>
    </ul>
</footer>
	</div>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
	<span id="adobe-target-experiment-container" hidden=""></span>


<div id="SLG_balloon_obj" alt="0" style="display: block;"><div id="SLG_button" class="SLG_ImTranslatorLogo" style="opacity: 100; background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/imtranslator-s.png&quot;);"></div><div id="SLG_shadow_translation_result2" style="display: none;"></div><div id="SLG_shadow_translator"><div id="SLG_planshet"><div id="SLG_arrow_up" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/up.png&quot;);"></div><div style="visibility:hidden;" id="SLG_Bproviders"><div class="SLG_BL_LABLE_ON" title="Google" id="SLG_P0"><div id="SLG_PN0">G</div></div><div class="SLG_BL_LABLE_ON" title="Microsoft" id="SLG_P1"><div id="SLG_PN1">M</div></div><div class="SLG_BL_LABLE_ON" title="Translator" id="SLG_P2"><div id="SLG_PN2">T</div></div></div><div id="SLG_alert_bbl"><div id="SLHKclose" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/delete.png&quot;);"></div><div id="SLG_alert_cont"></div></div><div id="SLG_TB"><table id="SLG_tables" cellspacing="1"><tr><td class="SLG_td" width="10%" align="right"><input id="SLG_locer" type="checkbox" checked="true" title="Lock-in language"></td><td class="SLG_td" width="20%" align="left"><select id="SLG_lng_from" class="SLG_lngs"><option value="auto">Detect language</option><option value="af">Afrikaans</option><option value="sq">Albanian</option><option value="am">Amharic</option><option value="ar">Arabic</option><option value="hy">Armenian</option><option value="az">Azerbaijani</option><option value="eu">Basque</option><option value="be">Belarusian</option><option value="bn">Bengali</option><option value="bs">Bosnian</option><option value="bg">Bulgarian</option><option value="ca">Catalan</option><option value="ceb">Cebuano</option><option value="ny">Chichewa</option><option value="zh-CN">Chinese (Simplified)</option><option value="zh-TW">Chinese (Traditional)</option><option value="co">Corsican</option><option value="hr">Croatian</option><option value="cs">Czech</option><option value="da">Danish</option><option value="nl">Dutch</option><option value="en">English</option><option value="eo">Esperanto</option><option value="et">Estonian</option><option value="tl">Filipino</option><option value="fi">Finnish</option><option value="fr">French</option><option value="fy">Frisian</option><option value="gl">Galician</option><option value="ka">Georgian</option><option value="de">German</option><option value="el">Greek</option><option value="gu">Gujarati</option><option value="ht">Haitian Creole</option><option value="ha">Hausa</option><option value="haw">Hawaiian</option><option value="iw">Hebrew</option><option value="hi">Hindi</option><option value="hmn">Hmong</option><option value="hu">Hungarian</option><option value="is">Icelandic</option><option value="ig">Igbo</option><option value="id">Indonesian</option><option value="ga">Irish</option><option value="it">Italian</option><option value="ja">Japanese</option><option value="jw">Javanese</option><option value="kn">Kannada</option><option value="kk">Kazakh</option><option value="km">Khmer</option><option value="ko">Korean</option><option value="ku">Kurdish</option><option value="ky">Kyrgyz</option><option value="lo">Lao</option><option value="la">Latin</option><option value="lv">Latvian</option><option value="lt">Lithuanian</option><option value="lb">Luxembourgish</option><option value="mk">Macedonian</option><option value="mg">Malagasy</option><option value="ms">Malay</option><option value="ml">Malayalam</option><option value="mt">Maltese</option><option value="mi">Maori</option><option value="mr">Marathi</option><option value="mn">Mongolian</option><option value="my">Myanmar (Burmese)</option><option value="ne">Nepali</option><option value="no">Norwegian</option><option value="ps">Pashto</option><option value="fa">Persian</option><option value="pl">Polish</option><option value="pt">Portuguese</option><option value="pa">Punjabi</option><option value="ro">Romanian</option><option value="ru">Russian</option><option value="sm">Samoan</option><option value="gd">Scots Gaelic</option><option value="sr">Serbian</option><option value="st">Sesotho</option><option value="sn">Shona</option><option value="sd">Sindhi</option><option value="si">Sinhala</option><option value="sk">Slovak</option><option value="sl">Slovenian</option><option value="so">Somali</option><option value="es">Spanish</option><option value="su">Sundanese</option><option value="sw">Swahili</option><option value="sv">Swedish</option><option value="tg">Tajik</option><option value="ta">Tamil</option><option value="te">Telugu</option><option value="th">Thai</option><option value="tr">Turkish</option><option value="uk">Ukrainian</option><option value="ur">Urdu</option><option value="uz">Uzbek</option><option value="vi">Vietnamese</option><option value="cy">Welsh</option><option value="xh">Xhosa</option><option value="yi">Yiddish</option><option value="yo">Yoruba</option><option value="zu">Zulu</option></select></td><td class="SLG_td" width="3" align="center"><div id="SLG_switch_b" title="Switch languages" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/switchb.png&quot;);"></div></td><td class="SLG_td" width="20%" align="left"><select id="SLG_lng_to" class="SLG_lngs"><option value="af">Afrikaans</option><option value="sq">Albanian</option><option value="am">Amharic</option><option value="ar">Arabic</option><option value="hy">Armenian</option><option value="az">Azerbaijani</option><option value="eu">Basque</option><option value="be">Belarusian</option><option value="bn">Bengali</option><option value="bs">Bosnian</option><option value="bg">Bulgarian</option><option value="ca">Catalan</option><option value="ceb">Cebuano</option><option value="ny">Chichewa</option><option value="zh-CN">Chinese (Simplified)</option><option value="zh-TW">Chinese (Traditional)</option><option value="co">Corsican</option><option value="hr">Croatian</option><option value="cs">Czech</option><option value="da">Danish</option><option value="nl">Dutch</option><option selected="selected" value="en">English</option><option value="eo">Esperanto</option><option value="et">Estonian</option><option value="tl">Filipino</option><option value="fi">Finnish</option><option value="fr">French</option><option value="fy">Frisian</option><option value="gl">Galician</option><option value="ka">Georgian</option><option value="de">German</option><option value="el">Greek</option><option value="gu">Gujarati</option><option value="ht">Haitian Creole</option><option value="ha">Hausa</option><option value="haw">Hawaiian</option><option value="iw">Hebrew</option><option value="hi">Hindi</option><option value="hmn">Hmong</option><option value="hu">Hungarian</option><option value="is">Icelandic</option><option value="ig">Igbo</option><option value="id">Indonesian</option><option value="ga">Irish</option><option value="it">Italian</option><option value="ja">Japanese</option><option value="jw">Javanese</option><option value="kn">Kannada</option><option value="kk">Kazakh</option><option value="km">Khmer</option><option value="ko">Korean</option><option value="ku">Kurdish</option><option value="ky">Kyrgyz</option><option value="lo">Lao</option><option value="la">Latin</option><option value="lv">Latvian</option><option value="lt">Lithuanian</option><option value="lb">Luxembourgish</option><option value="mk">Macedonian</option><option value="mg">Malagasy</option><option value="ms">Malay</option><option value="ml">Malayalam</option><option value="mt">Maltese</option><option value="mi">Maori</option><option value="mr">Marathi</option><option value="mn">Mongolian</option><option value="my">Myanmar (Burmese)</option><option value="ne">Nepali</option><option value="no">Norwegian</option><option value="ps">Pashto</option><option value="fa">Persian</option><option value="pl">Polish</option><option value="pt">Portuguese</option><option value="pa">Punjabi</option><option value="ro">Romanian</option><option value="ru">Russian</option><option value="sm">Samoan</option><option value="gd">Scots Gaelic</option><option value="sr">Serbian</option><option value="st">Sesotho</option><option value="sn">Shona</option><option value="sd">Sindhi</option><option value="si">Sinhala</option><option value="sk">Slovak</option><option value="sl">Slovenian</option><option value="so">Somali</option><option value="es">Spanish</option><option value="su">Sundanese</option><option value="sw">Swahili</option><option value="sv">Swedish</option><option value="tg">Tajik</option><option value="ta">Tamil</option><option value="te">Telugu</option><option value="th">Thai</option><option value="tr">Turkish</option><option value="uk">Ukrainian</option><option value="ur">Urdu</option><option value="uz">Uzbek</option><option value="vi">Vietnamese</option><option value="cy">Welsh</option><option value="xh">Xhosa</option><option value="yi">Yiddish</option><option value="yo">Yoruba</option><option value="zu">Zulu</option></select></td><td class="SLG_td" width="5%" align="center"> </td><td class="SLG_td" width="8%" align="center"><div id="SLG_TTS_voice" title="undefined" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/ttsvoice.png&quot;);"></div></td><td class="SLG_td" width="8%" align="center"><div id="SLG_copy" title="Copy translation" class="SLG_copy" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/copy.png&quot;);"><div id="SLG_copy_tip"></div></div></td><td class="SLG_td" width="8%" align="center"><div id="SLG_bbl_font_patch"></div><div id="SLG_bbl_font" title="Font size" class="SLG_bbl_font" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/font.png&quot;);"></div></td><td class="SLG_td" width="8%" align="center"><div id="SLG_bbl_help" title="Help" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/bhelp.png&quot;);"></div></td><td class="SLG_td" width="15%" align="right"><div id="SLG_pin" class="SLG_pin_off" title="Pin pop-up bubble" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/pin-on.png&quot;);"></div></td></tr></table></div></div><div id="SLG_shadow_translation_result"></div><div id="SLG_loading" class="SLG_loading" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/loading.gif&quot;);"></div><div id="SLG_player2"></div><div id="SLG_alert100">Text-to-speech function is limited to 200 characters</div><div id="SLG_Balloon_options" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/bg3.png&quot;) rgb(255, 255, 255);"><div id="SLG_arrow_down" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/down.png&quot;);"></div><table id="SLG_tbl_opt" width="100%"><tr><td class="SLG_td" width="5%" align="center"><input id="SLG_BBL_locer" type="checkbox" checked="true" title="Show Translator&#39;s button 3 second(s)"></td><td class="SLG_td" width="5%" align="left"><div id="SLG_BBL_IMG" title="Show Translator&#39;s button 3 second(s)" style="background: url(&quot;chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/img/util/bbl-logo.png&quot;);"></div></td><td class="SLG_td" width="70%" align="center"><a href="chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/html/options/options.html?bbl" target="_blank" class="SLG_options" title="Show options">Options</a> : <a href="chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/html/options/options.html?hist" target="_blank" class="SLG_options" title="Translation History">History</a> : <a href="chrome-extension://mchdgimobfnilobnllpdnompfjkkfdmi/content/html/options/options.html?feed" target="_blank" class="SLG_options" title="ImTranslator Feedback">Feedback</a> : <a href="https://imtranslator.net/extensions/?tp=chr-ImTranslator&amp;a=0" target="_blank" class="SLG_options" title="Make a small contribution">Donate</a></td><td class="SLG_td" width="15%" align="right"><span id="SLG_Balloon_Close" class="SLG_options" title="Close">Close</span></td></tr></table></div></div></div></body></html>